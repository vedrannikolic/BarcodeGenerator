/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/@zxing/library@0.21.0/esm/core/common/detector/WhiteRectangleDetector.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import ResultPoint from"../../ResultPoint";import MathUtils from"./MathUtils";import NotFoundException from"../../NotFoundException";var WhiteRectangleDetector=function(){function t(n,i,e,o){this.image=n,this.height=n.getHeight(),this.width=n.getWidth(),null==i&&(i=t.INIT_SIZE),null==e&&(e=n.getWidth()/2|0),null==o&&(o=n.getHeight()/2|0);var r=i/2|0;if(this.leftInit=e-r,this.rightInit=e+r,this.upInit=o-r,this.downInit=o+r,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new NotFoundException}return t.prototype.detect=function(){for(var t=this.leftInit,n=this.rightInit,i=this.upInit,e=this.downInit,o=!1,r=!0,l=!1,h=!1,s=!1,u=!1,a=!1,g=this.width,f=this.height;r;){r=!1;for(var c=!0;(c||!h)&&n<g;)(c=this.containsBlackPoint(i,e,n,!1))?(n++,r=!0,h=!0):h||n++;if(n>=g){o=!0;break}for(var w=!0;(w||!s)&&e<f;)(w=this.containsBlackPoint(t,n,e,!0))?(e++,r=!0,s=!0):s||e++;if(e>=f){o=!0;break}for(var d=!0;(d||!u)&&t>=0;)(d=this.containsBlackPoint(i,e,t,!1))?(t--,r=!0,u=!0):u||t--;if(t<0){o=!0;break}for(var p=!0;(p||!a)&&i>=0;)(p=this.containsBlackPoint(t,n,i,!0))?(i--,r=!0,a=!0):a||i--;if(i<0){o=!0;break}r&&(l=!0)}if(!o&&l){for(var P=n-t,I=null,v=1;null===I&&v<P;v++)I=this.getBlackPointOnSegment(t,e-v,t+v,e);if(null==I)throw new NotFoundException;var R=null;for(v=1;null===R&&v<P;v++)R=this.getBlackPointOnSegment(t,i+v,t+v,i);if(null==R)throw new NotFoundException;var k=null;for(v=1;null===k&&v<P;v++)k=this.getBlackPointOnSegment(n,i+v,n-v,i);if(null==k)throw new NotFoundException;var m=null;for(v=1;null===m&&v<P;v++)m=this.getBlackPointOnSegment(n,e-v,n-v,e);if(null==m)throw new NotFoundException;return this.centerEdges(m,I,k,R)}throw new NotFoundException},t.prototype.getBlackPointOnSegment=function(t,n,i,e){for(var o=MathUtils.round(MathUtils.distance(t,n,i,e)),r=(i-t)/o,l=(e-n)/o,h=this.image,s=0;s<o;s++){var u=MathUtils.round(t+s*r),a=MathUtils.round(n+s*l);if(h.get(u,a))return new ResultPoint(u,a)}return null},t.prototype.centerEdges=function(n,i,e,o){var r=n.getX(),l=n.getY(),h=i.getX(),s=i.getY(),u=e.getX(),a=e.getY(),g=o.getX(),f=o.getY(),c=t.CORR;return r<this.width/2?[new ResultPoint(g-c,f+c),new ResultPoint(h+c,s+c),new ResultPoint(u-c,a-c),new ResultPoint(r+c,l-c)]:[new ResultPoint(g+c,f+c),new ResultPoint(h+c,s-c),new ResultPoint(u-c,a+c),new ResultPoint(r-c,l-c)]},t.prototype.containsBlackPoint=function(t,n,i,e){var o=this.image;if(e){for(var r=t;r<=n;r++)if(o.get(r,i))return!0}else for(var l=t;l<=n;l++)if(o.get(i,l))return!0;return!1},t.INIT_SIZE=10,t.CORR=1,t}();export default WhiteRectangleDetector;
//# sourceMappingURL=/sm/efff951c9d8dc481ca30b9eaf2aa4366fd4f7040ae6d504e19f20578b010b207.map