/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/@zxing/library@0.21.0/esm/core/common/MinimalECIInput.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{ECIEncoderSet}from"./ECIEncoderSet";import Integer from"../util/Integer";import StringBuilder from"../util/StringBuilder";var COST_PER_ECI=3,MinimalECIInput=function(){function t(t,e,r){this.fnc1=r;var n=new ECIEncoderSet(t,e,r);if(1===n.length())for(var i=0;i<this.bytes.length;i++){var o=t.charAt(i).charCodeAt(0);this.bytes[i]=o===r?1e3:o}else this.bytes=this.encodeMinimally(t,n,r)}return t.prototype.getFNC1Character=function(){return this.fnc1},t.prototype.length=function(){return this.bytes.length},t.prototype.haveNCharacters=function(t,e){if(t+e-1>=this.bytes.length)return!1;for(var r=0;r<e;r++)if(this.isECI(t+r))return!1;return!0},t.prototype.charAt=function(t){if(t<0||t>=this.length())throw new Error(""+t);if(this.isECI(t))throw new Error("value at "+t+" is not a character but an ECI");return this.isFNC1(t)?this.fnc1:this.bytes[t]},t.prototype.subSequence=function(t,e){if(t<0||t>e||e>this.length())throw new Error(""+t);for(var r=new StringBuilder,n=t;n<e;n++){if(this.isECI(n))throw new Error("value at "+n+" is not a character but an ECI");r.append(this.charAt(n))}return r.toString()},t.prototype.isECI=function(t){if(t<0||t>=this.length())throw new Error(""+t);return this.bytes[t]>255&&this.bytes[t]<=999},t.prototype.isFNC1=function(t){if(t<0||t>=this.length())throw new Error(""+t);return 1e3===this.bytes[t]},t.prototype.getECIValue=function(t){if(t<0||t>=this.length())throw new Error(""+t);if(!this.isECI(t))throw new Error("value at "+t+" is not an ECI but a character");return this.bytes[t]-256},t.prototype.addEdge=function(t,e,r){(null==t[e][r.encoderIndex]||t[e][r.encoderIndex].cachedTotalSize>r.cachedTotalSize)&&(t[e][r.encoderIndex]=r)},t.prototype.addEdges=function(t,e,r,n,i,o){var h=t.charAt(n).charCodeAt(0),c=0,a=e.length();e.getPriorityEncoderIndex()>=0&&(h===o||e.canEncode(h,e.getPriorityEncoderIndex()))&&(a=(c=e.getPriorityEncoderIndex())+1);for(var s=c;s<a;s++)(h===o||e.canEncode(h,s))&&this.addEdge(r,n+1,new InputEdge(h,e,s,i,o))},t.prototype.encodeMinimally=function(t,e,r){var n=t.length,i=new(InputEdge[n+1][e.length()]);this.addEdges(t,e,i,0,null,r);for(var o=1;o<=n;o++){for(var h=0;h<e.length();h++)null!=i[o][h]&&o<n&&this.addEdges(t,e,i,o,i[o][h],r);for(h=0;h<e.length();h++)i[o-1][h]=null}var c=-1,a=Integer.MAX_VALUE;for(h=0;h<e.length();h++)if(null!=i[n][h]){var s=i[n][h];s.cachedTotalSize<a&&(a=s.cachedTotalSize,c=h)}if(c<0)throw new Error('Failed to encode "'+t+'"');for(var d=[],u=i[n][c];null!=u;){if(u.isFNC1())d.unshift(1e3);else{var l=e.encode(u.c,u.encoderIndex);for(o=l.length-1;o>=0;o--)d.unshift(255&l[o])}(null===u.previous?0:u.previous.encoderIndex)!==u.encoderIndex&&d.unshift(256+e.getECIValue(u.encoderIndex)),u=u.previous}var f=[];for(o=0;o<f.length;o++)f[o]=d[o];return f},t}();export{MinimalECIInput};var InputEdge=function(){function t(t,e,r,n,i){this.c=t,this.encoderSet=e,this.encoderIndex=r,this.previous=n,this.fnc1=i,this.c=t===i?1e3:t;var o=this.isFNC1()?1:e.encode(t,r).length;(null===n?0:n.encoderIndex)!==r&&(o+=COST_PER_ECI),null!=n&&(o+=n.cachedTotalSize),this.cachedTotalSize=o}return t.prototype.isFNC1=function(){return 1e3===this.c},t}();
//# sourceMappingURL=/sm/580cd338947ff88d27d8a88ad1e57232b220c88816a77eda154cf27903b9c7f9.map