/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/@zxing/library@0.21.0/esm/core/common/reedsolomon/ReedSolomonDecoder.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import GenericGF from"./GenericGF";import GenericGFPoly from"./GenericGFPoly";import ReedSolomonException from"../../ReedSolomonException";import IllegalStateException from"../../IllegalStateException";var ReedSolomonDecoder=function(){function e(e){this.field=e}return e.prototype.decode=function(e,r){for(var t=this.field,o=new GenericGFPoly(t,e),i=new Int32Array(r),n=!0,l=0;l<r;l++){var a=o.evaluateAt(t.exp(l+t.getGeneratorBase()));i[i.length-1-l]=a,0!==a&&(n=!1)}if(!n){var g=new GenericGFPoly(t,i),f=this.runEuclideanAlgorithm(t.buildMonomial(r,1),g,r),c=f[0],d=f[1],u=this.findErrorLocations(c),m=this.findErrorMagnitudes(d,u);for(l=0;l<u.length;l++){var p=e.length-1-t.log(u[l]);if(p<0)throw new ReedSolomonException("Bad error location");e[p]=GenericGF.addOrSubtract(e[p],m[l])}}},e.prototype.runEuclideanAlgorithm=function(e,r,t){if(e.getDegree()<r.getDegree()){var o=e;e=r,r=o}for(var i=this.field,n=e,l=r,a=i.getZero(),g=i.getOne();l.getDegree()>=(t/2|0);){var f=n,c=a;if(a=g,(n=l).isZero())throw new ReedSolomonException("r_{i-1} was zero");l=f;for(var d=i.getZero(),u=n.getCoefficient(n.getDegree()),m=i.inverse(u);l.getDegree()>=n.getDegree()&&!l.isZero();){var p=l.getDegree()-n.getDegree(),s=i.multiply(l.getCoefficient(l.getDegree()),m);d=d.addOrSubtract(i.buildMonomial(p,s)),l=l.addOrSubtract(n.multiplyByMonomial(p,s))}if(g=d.multiply(a).addOrSubtract(c),l.getDegree()>=n.getDegree())throw new IllegalStateException("Division algorithm failed to reduce polynomial?")}var v=g.getCoefficient(0);if(0===v)throw new ReedSolomonException("sigmaTilde(0) was zero");var y=i.inverse(v);return[g.multiplyScalar(y),l.multiplyScalar(y)]},e.prototype.findErrorLocations=function(e){var r=e.getDegree();if(1===r)return Int32Array.from([e.getCoefficient(1)]);for(var t=new Int32Array(r),o=0,i=this.field,n=1;n<i.getSize()&&o<r;n++)0===e.evaluateAt(n)&&(t[o]=i.inverse(n),o++);if(o!==r)throw new ReedSolomonException("Error locator degree does not match number of roots");return t},e.prototype.findErrorMagnitudes=function(e,r){for(var t=r.length,o=new Int32Array(t),i=this.field,n=0;n<t;n++){for(var l=i.inverse(r[n]),a=1,g=0;g<t;g++)if(n!==g){var f=i.multiply(r[g],l),c=0==(1&f)?1|f:-2&f;a=i.multiply(a,c)}o[n]=i.multiply(e.evaluateAt(l),i.inverse(a)),0!==i.getGeneratorBase()&&(o[n]=i.multiply(o[n],l))}return o},e}();export default ReedSolomonDecoder;
//# sourceMappingURL=/sm/a19f78a19f396e453290e0f9b9413f7555127d7391c2597e0ecd0cbe3d93fb31.map