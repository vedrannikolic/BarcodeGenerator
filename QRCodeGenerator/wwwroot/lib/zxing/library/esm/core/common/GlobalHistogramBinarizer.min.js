/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/@zxing/library@0.21.0/esm/core/common/GlobalHistogramBinarizer.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var __extends=this&&this.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])},t(r,e)};return function(r,e){function i(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();import Binarizer from"../Binarizer";import BitArray from"./BitArray";import BitMatrix from"./BitMatrix";import NotFoundException from"../NotFoundException";var GlobalHistogramBinarizer=function(t){function r(e){var i=t.call(this,e)||this;return i.luminances=r.EMPTY,i.buckets=new Int32Array(r.LUMINANCE_BUCKETS),i}return __extends(r,t),r.prototype.getBlackRow=function(t,e){var i=this.getLuminanceSource(),n=i.getWidth();null==e||e.getSize()<n?e=new BitArray(n):e.clear(),this.initArrays(n);for(var o=i.getRow(t,this.luminances),a=this.buckets,s=0;s<n;s++)a[(255&o[s])>>r.LUMINANCE_SHIFT]++;var c=r.estimateBlackPoint(a);if(n<3)for(s=0;s<n;s++)(255&o[s])<c&&e.set(s);else{var u=255&o[0],f=255&o[1];for(s=1;s<n-1;s++){var l=255&o[s+1];(4*f-u-l)/2<c&&e.set(s),u=f,f=l}}return e},r.prototype.getBlackMatrix=function(){var t=this.getLuminanceSource(),e=t.getWidth(),i=t.getHeight(),n=new BitMatrix(e,i);this.initArrays(e);for(var o=this.buckets,a=1;a<5;a++)for(var s=Math.floor(i*a/5),c=t.getRow(s,this.luminances),u=Math.floor(4*e/5),f=Math.floor(e/5);f<u;f++){o[(255&c[f])>>r.LUMINANCE_SHIFT]++}var l=r.estimateBlackPoint(o),p=t.getMatrix();for(a=0;a<i;a++){var h=a*e;for(f=0;f<e;f++){(255&p[h+f])<l&&n.set(f,a)}}return n},r.prototype.createBinarizer=function(t){return new r(t)},r.prototype.initArrays=function(t){this.luminances.length<t&&(this.luminances=new Uint8ClampedArray(t));for(var e=this.buckets,i=0;i<r.LUMINANCE_BUCKETS;i++)e[i]=0},r.estimateBlackPoint=function(t){for(var e=t.length,i=0,n=0,o=0,a=0;a<e;a++)t[a]>o&&(n=a,o=t[a]),t[a]>i&&(i=t[a]);var s=0,c=0;for(a=0;a<e;a++){var u=a-n;(h=t[a]*u*u)>c&&(s=a,c=h)}if(n>s){var f=n;n=s,s=f}if(s-n<=e/16)throw new NotFoundException;var l=s-1,p=-1;for(a=s-1;a>n;a--){var h,_=a-n;(h=_*_*(s-a)*(i-t[a]))>p&&(l=a,p=h)}return l<<r.LUMINANCE_SHIFT},r.LUMINANCE_BITS=5,r.LUMINANCE_SHIFT=8-r.LUMINANCE_BITS,r.LUMINANCE_BUCKETS=1<<r.LUMINANCE_BITS,r.EMPTY=Uint8ClampedArray.from([0]),r}(Binarizer);export default GlobalHistogramBinarizer;
//# sourceMappingURL=/sm/4611279cbf05ea8cea546631e787f39943e30337c070b4bafa1c5dcc8aea7f63.map