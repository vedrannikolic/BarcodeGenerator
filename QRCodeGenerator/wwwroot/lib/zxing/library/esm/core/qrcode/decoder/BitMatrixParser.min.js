/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/@zxing/library@0.21.0/esm/core/qrcode/decoder/BitMatrixParser.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import Version from"./Version";import FormatInformation from"./FormatInformation";import DataMask from"./DataMask";import FormatException from"../../FormatException";var BitMatrixParser=function(){function t(t){var r=t.getHeight();if(r<21||1!=(3&r))throw new FormatException;this.bitMatrix=t}return t.prototype.readFormatInformation=function(){if(null!==this.parsedFormatInfo&&void 0!==this.parsedFormatInfo)return this.parsedFormatInfo;for(var t=0,r=0;r<6;r++)t=this.copyBit(r,8,t);t=this.copyBit(7,8,t),t=this.copyBit(8,8,t),t=this.copyBit(8,7,t);for(var i=5;i>=0;i--)t=this.copyBit(8,i,t);var o=this.bitMatrix.getHeight(),e=0,a=o-7;for(i=o-1;i>=a;i--)e=this.copyBit(8,i,e);for(r=o-8;r<o;r++)e=this.copyBit(r,8,e);if(this.parsedFormatInfo=FormatInformation.decodeFormatInformation(t,e),null!==this.parsedFormatInfo)return this.parsedFormatInfo;throw new FormatException},t.prototype.readVersion=function(){if(null!==this.parsedVersion&&void 0!==this.parsedVersion)return this.parsedVersion;var t=this.bitMatrix.getHeight(),r=Math.floor((t-17)/4);if(r<=6)return Version.getVersionForNumber(r);for(var i=0,o=t-11,e=5;e>=0;e--)for(var a=t-9;a>=o;a--)i=this.copyBit(a,e,i);var n=Version.decodeVersionInformation(i);if(null!==n&&n.getDimensionForVersion()===t)return this.parsedVersion=n,n;i=0;for(a=5;a>=0;a--)for(e=t-9;e>=o;e--)i=this.copyBit(a,e,i);if(null!==(n=Version.decodeVersionInformation(i))&&n.getDimensionForVersion()===t)return this.parsedVersion=n,n;throw new FormatException},t.prototype.copyBit=function(t,r,i){return(this.isMirror?this.bitMatrix.get(r,t):this.bitMatrix.get(t,r))?i<<1|1:i<<1},t.prototype.readCodewords=function(){var t=this.readFormatInformation(),r=this.readVersion(),i=DataMask.values.get(t.getDataMask()),o=this.bitMatrix.getHeight();i.unmaskBitMatrix(this.bitMatrix,o);for(var e=r.buildFunctionPattern(),a=!0,n=new Uint8Array(r.getTotalCodewords()),s=0,f=0,p=0,h=o-1;h>0;h-=2){6===h&&h--;for(var m=0;m<o;m++)for(var d=a?o-1-m:m,u=0;u<2;u++)e.get(h-u,d)||(p++,f<<=1,this.bitMatrix.get(h-u,d)&&(f|=1),8===p&&(n[s++]=f,p=0,f=0));a=!a}if(s!==r.getTotalCodewords())throw new FormatException;return n},t.prototype.remask=function(){if(null!==this.parsedFormatInfo){var t=DataMask.values[this.parsedFormatInfo.getDataMask()],r=this.bitMatrix.getHeight();t.unmaskBitMatrix(this.bitMatrix,r)}},t.prototype.setMirror=function(t){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=t},t.prototype.mirror=function(){for(var t=this.bitMatrix,r=0,i=t.getWidth();r<i;r++)for(var o=r+1,e=t.getHeight();o<e;o++)t.get(r,o)!==t.get(o,r)&&(t.flip(o,r),t.flip(r,o))},t}();export default BitMatrixParser;
//# sourceMappingURL=/sm/086411eacb5e301f021c6b407ff5bfc48a5623eec42794d115fcbb93b870a5ac.map