/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/@zxing/library@0.21.0/esm/core/datamatrix/encoder/EdifactEncoder.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import StringUtils from"../../common/StringUtils";import StringBuilder from"../../util/StringBuilder";import{EDIFACT_ENCODATION,ASCII_ENCODATION}from"./constants";import HighLevelEncoder from"./HighLevelEncoder";var EdifactEncoder=function(){function t(){}return t.prototype.getEncodingMode=function(){return EDIFACT_ENCODATION},t.prototype.encode=function(t){for(var e=new StringBuilder;t.hasMoreCharacters();){var o=t.getCurrentChar();if(this.encodeChar(o,e),t.pos++,e.length()>=4){t.writeCodewords(this.encodeToCodewords(e.toString()));var r=e.toString().substring(4);if(e.setLengthToZero(),e.append(r),HighLevelEncoder.lookAheadTest(t.getMessage(),t.pos,this.getEncodingMode())!==this.getEncodingMode()){t.signalEncoderChange(ASCII_ENCODATION);break}}}e.append(StringUtils.getCharAt(31)),this.handleEOD(t,e)},t.prototype.handleEOD=function(t,e){try{var o=e.length();if(0===o)return;if(1===o){t.updateSymbolInfo();var r=t.getSymbolInfo().getDataCapacity()-t.getCodewordCount(),n=t.getRemainingCharacters();if(n>r&&(t.updateSymbolInfo(t.getCodewordCount()+1),r=t.getSymbolInfo().getDataCapacity()-t.getCodewordCount()),n<=r&&r<=2)return}if(o>4)throw new Error("Count must not exceed 4");var a=o-1,d=this.encodeToCodewords(e.toString()),i=!t.hasMoreCharacters()&&a<=2;if(a<=2)t.updateSymbolInfo(t.getCodewordCount()+a),(r=t.getSymbolInfo().getDataCapacity()-t.getCodewordCount())>=3&&(i=!1,t.updateSymbolInfo(t.getCodewordCount()+d.length));i?(t.resetSymbolInfo(),t.pos-=a):t.writeCodewords(d)}finally{t.signalEncoderChange(ASCII_ENCODATION)}},t.prototype.encodeChar=function(t,e){t>=" ".charCodeAt(0)&&t<="?".charCodeAt(0)?e.append(t):t>="@".charCodeAt(0)&&t<="^".charCodeAt(0)?e.append(StringUtils.getCharAt(t-64)):HighLevelEncoder.illegalCharacter(StringUtils.getCharAt(t))},t.prototype.encodeToCodewords=function(t){var e=t.length;if(0===e)throw new Error("StringBuilder must not be empty");var o=(t.charAt(0).charCodeAt(0)<<18)+((e>=2?t.charAt(1).charCodeAt(0):0)<<12)+((e>=3?t.charAt(2).charCodeAt(0):0)<<6)+(e>=4?t.charAt(3).charCodeAt(0):0),r=o>>16&255,n=o>>8&255,a=255&o,d=new StringBuilder;return d.append(r),e>=2&&d.append(n),e>=3&&d.append(a),d.toString()},t}();export{EdifactEncoder};
//# sourceMappingURL=/sm/5f7bfa6ebc72b7055cae22f504d7a755350720fc5a43f5c0a01b216792affce3.map