/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/@zxing/library@0.21.0/esm/core/datamatrix/encoder/HighLevelEncoder.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{ASCIIEncoder}from"./ASCIIEncoder";import{Base256Encoder}from"./Base256Encoder";import{C40Encoder}from"./C40Encoder";import{ASCII_ENCODATION,BASE256_ENCODATION,C40_ENCODATION,EDIFACT_ENCODATION,MACRO_05,MACRO_05_HEADER,MACRO_06,MACRO_06_HEADER,MACRO_TRAILER,PAD,TEXT_ENCODATION,X12_ENCODATION}from"./constants";import{EdifactEncoder}from"./EdifactEncoder";import{EncoderContext}from"./EncoderContext";import{X12Encoder}from"./X12Encoder";import{TextEncoder}from"./TextEncoder";import Arrays from"../../util/Arrays";import Integer from"../../util/Integer";var HighLevelEncoder=function(){function t(){}return t.randomize253State=function(t){var e=PAD+(149*t%253+1);return e<=254?e:e-254},t.encodeHighLevel=function(t,e,A,r,C){void 0===e&&(e=0),void 0===A&&(A=null),void 0===r&&(r=null),void 0===C&&(C=!1);var N=new C40Encoder,O=[new ASCIIEncoder,N,new TextEncoder,new X12Encoder,new EdifactEncoder,new Base256Encoder],i=new EncoderContext(t);i.setSymbolShape(e),i.setSizeConstraints(A,r),t.startsWith(MACRO_05_HEADER)&&t.endsWith(MACRO_TRAILER)?(i.writeCodeword(MACRO_05),i.setSkipAtEnd(2),i.pos+=MACRO_05_HEADER.length):t.startsWith(MACRO_06_HEADER)&&t.endsWith(MACRO_TRAILER)&&(i.writeCodeword(MACRO_06),i.setSkipAtEnd(2),i.pos+=MACRO_06_HEADER.length);var E=ASCII_ENCODATION;for(C&&(N.encodeMaximal(i),E=i.getNewEncoding(),i.resetEncoderSignal());i.hasMoreCharacters();)O[E].encode(i),i.getNewEncoding()>=0&&(E=i.getNewEncoding(),i.resetEncoderSignal());var n=i.getCodewordCount();i.updateSymbolInfo();var I=i.getSymbolInfo().getDataCapacity();n<I&&E!==ASCII_ENCODATION&&E!==BASE256_ENCODATION&&E!==EDIFACT_ENCODATION&&i.writeCodeword("Ã¾");var T=i.getCodewords();for(T.length()<I&&T.append(PAD);T.length()<I;)T.append(this.randomize253State(T.length()+1));return i.getCodewords().toString()},t.lookAheadTest=function(t,e,A){var r=this.lookAheadTestIntern(t,e,A);if(A===X12_ENCODATION&&r===X12_ENCODATION){for(var C=Math.min(e+3,t.length),N=e;N<C;N++)if(!this.isNativeX12(t.charCodeAt(N)))return ASCII_ENCODATION}else if(A===EDIFACT_ENCODATION&&r===EDIFACT_ENCODATION)for(C=Math.min(e+4,t.length),N=e;N<C;N++)if(!this.isNativeEDIFACT(t.charCodeAt(N)))return ASCII_ENCODATION;return r},t.lookAheadTestIntern=function(t,e,A){if(e>=t.length)return A;var r;A===ASCII_ENCODATION?r=[0,1,1,1,1,1.25]:(r=[1,2,2,2,2,2.25])[A]=0;for(var C=0,N=new Uint8Array(6),O=[];;){if(e+C===t.length){Arrays.fill(N,0),Arrays.fill(O,0);var i=this.findMinimums(r,O,Integer.MAX_VALUE,N),E=this.getMinimumCount(N);if(O[ASCII_ENCODATION]===i)return ASCII_ENCODATION;if(1===E){if(N[BASE256_ENCODATION]>0)return BASE256_ENCODATION;if(N[EDIFACT_ENCODATION]>0)return EDIFACT_ENCODATION;if(N[TEXT_ENCODATION]>0)return TEXT_ENCODATION;if(N[X12_ENCODATION]>0)return X12_ENCODATION}return C40_ENCODATION}var n=t.charCodeAt(e+C);if(C++,this.isDigit(n)?r[ASCII_ENCODATION]+=.5:this.isExtendedASCII(n)?(r[ASCII_ENCODATION]=Math.ceil(r[ASCII_ENCODATION]),r[ASCII_ENCODATION]+=2):(r[ASCII_ENCODATION]=Math.ceil(r[ASCII_ENCODATION]),r[ASCII_ENCODATION]++),this.isNativeC40(n)?r[C40_ENCODATION]+=2/3:this.isExtendedASCII(n)?r[C40_ENCODATION]+=8/3:r[C40_ENCODATION]+=4/3,this.isNativeText(n)?r[TEXT_ENCODATION]+=2/3:this.isExtendedASCII(n)?r[TEXT_ENCODATION]+=8/3:r[TEXT_ENCODATION]+=4/3,this.isNativeX12(n)?r[X12_ENCODATION]+=2/3:this.isExtendedASCII(n)?r[X12_ENCODATION]+=13/3:r[X12_ENCODATION]+=10/3,this.isNativeEDIFACT(n)?r[EDIFACT_ENCODATION]+=3/4:this.isExtendedASCII(n)?r[EDIFACT_ENCODATION]+=4.25:r[EDIFACT_ENCODATION]+=3.25,this.isSpecialB256(n)?r[BASE256_ENCODATION]+=4:r[BASE256_ENCODATION]++,C>=4){if(Arrays.fill(N,0),Arrays.fill(O,0),this.findMinimums(r,O,Integer.MAX_VALUE,N),O[ASCII_ENCODATION]<this.min(O[BASE256_ENCODATION],O[C40_ENCODATION],O[TEXT_ENCODATION],O[X12_ENCODATION],O[EDIFACT_ENCODATION]))return ASCII_ENCODATION;if(O[BASE256_ENCODATION]<O[ASCII_ENCODATION]||O[BASE256_ENCODATION]+1<this.min(O[C40_ENCODATION],O[TEXT_ENCODATION],O[X12_ENCODATION],O[EDIFACT_ENCODATION]))return BASE256_ENCODATION;if(O[EDIFACT_ENCODATION]+1<this.min(O[BASE256_ENCODATION],O[C40_ENCODATION],O[TEXT_ENCODATION],O[X12_ENCODATION],O[ASCII_ENCODATION]))return EDIFACT_ENCODATION;if(O[TEXT_ENCODATION]+1<this.min(O[BASE256_ENCODATION],O[C40_ENCODATION],O[EDIFACT_ENCODATION],O[X12_ENCODATION],O[ASCII_ENCODATION]))return TEXT_ENCODATION;if(O[X12_ENCODATION]+1<this.min(O[BASE256_ENCODATION],O[C40_ENCODATION],O[EDIFACT_ENCODATION],O[TEXT_ENCODATION],O[ASCII_ENCODATION]))return X12_ENCODATION;if(O[C40_ENCODATION]+1<this.min(O[ASCII_ENCODATION],O[BASE256_ENCODATION],O[EDIFACT_ENCODATION],O[TEXT_ENCODATION])){if(O[C40_ENCODATION]<O[X12_ENCODATION])return C40_ENCODATION;if(O[C40_ENCODATION]===O[X12_ENCODATION]){for(var I=e+C+1;I<t.length;){var T=t.charCodeAt(I);if(this.isX12TermSep(T))return X12_ENCODATION;if(!this.isNativeX12(T))break;I++}return C40_ENCODATION}}}}},t.min=function(t,e,A,r,C){var N=Math.min(t,Math.min(e,Math.min(A,r)));return void 0===C?N:Math.min(N,C)},t.findMinimums=function(t,e,A,r){for(var C=0;C<6;C++){var N=e[C]=Math.ceil(t[C]);A>N&&(A=N,Arrays.fill(r,0)),A===N&&(r[C]=r[C]+1)}return A},t.getMinimumCount=function(t){for(var e=0,A=0;A<6;A++)e+=t[A];return e||0},t.isDigit=function(t){return t>="0".charCodeAt(0)&&t<="9".charCodeAt(0)},t.isExtendedASCII=function(t){return t>=128&&t<=255},t.isNativeC40=function(t){return t===" ".charCodeAt(0)||t>="0".charCodeAt(0)&&t<="9".charCodeAt(0)||t>="A".charCodeAt(0)&&t<="Z".charCodeAt(0)},t.isNativeText=function(t){return t===" ".charCodeAt(0)||t>="0".charCodeAt(0)&&t<="9".charCodeAt(0)||t>="a".charCodeAt(0)&&t<="z".charCodeAt(0)},t.isNativeX12=function(t){return this.isX12TermSep(t)||t===" ".charCodeAt(0)||t>="0".charCodeAt(0)&&t<="9".charCodeAt(0)||t>="A".charCodeAt(0)&&t<="Z".charCodeAt(0)},t.isX12TermSep=function(t){return 13===t||t==="*".charCodeAt(0)||t===">".charCodeAt(0)},t.isNativeEDIFACT=function(t){return t>=" ".charCodeAt(0)&&t<="^".charCodeAt(0)},t.isSpecialB256=function(t){return!1},t.determineConsecutiveDigitCount=function(t,e){void 0===e&&(e=0);for(var A=t.length,r=e;r<A&&this.isDigit(t.charCodeAt(r));)r++;return r-e},t.illegalCharacter=function(t){var e=Integer.toHexString(t.charCodeAt(0));throw e="0000".substring(0,4-e.length)+e,new Error("Illegal character: "+t+" (0x"+e+")")},t}();export default HighLevelEncoder;
//# sourceMappingURL=/sm/b458381598d2c86857f1e1361359160c009a303c60c120d7e0e0a66d50f24785.map