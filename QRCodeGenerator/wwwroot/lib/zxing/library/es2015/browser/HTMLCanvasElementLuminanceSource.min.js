/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/@zxing/library@0.21.0/es2015/browser/HTMLCanvasElementLuminanceSource.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import InvertedLuminanceSource from"../core/InvertedLuminanceSource";import LuminanceSource from"../core/LuminanceSource";import IllegalArgumentException from"../core/IllegalArgumentException";export class HTMLCanvasElementLuminanceSource extends LuminanceSource{constructor(e){super(e.width,e.height),this.canvas=e,this.tempCanvasElement=null,this.buffer=HTMLCanvasElementLuminanceSource.makeBufferFromCanvasImageData(e)}static makeBufferFromCanvasImageData(e){const t=e.getContext("2d").getImageData(0,0,e.width,e.height);return HTMLCanvasElementLuminanceSource.toGrayscaleBuffer(t.data,e.width,e.height)}static toGrayscaleBuffer(e,t,a){const n=new Uint8ClampedArray(t*a);if(HTMLCanvasElementLuminanceSource.FRAME_INDEX=!HTMLCanvasElementLuminanceSource.FRAME_INDEX,HTMLCanvasElementLuminanceSource.FRAME_INDEX)for(let t=0,a=0,r=e.length;t<r;t+=4,a++){let r;if(0===e[t+3])r=255;else{r=306*e[t]+601*e[t+1]+117*e[t+2]+512>>10}n[a]=r}else for(let t=0,a=0,r=e.length;t<r;t+=4,a++){let r;if(0===e[t+3])r=255;else{r=306*e[t]+601*e[t+1]+117*e[t+2]+512>>10}n[a]=255-r}return n}getRow(e,t){if(e<0||e>=this.getHeight())throw new IllegalArgumentException("Requested row is outside the image: "+e);const a=this.getWidth(),n=e*a;return null===t?t=this.buffer.slice(n,n+a):(t.length<a&&(t=new Uint8ClampedArray(a)),t.set(this.buffer.slice(n,n+a))),t}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(e,t,a,n){return super.crop(e,t,a,n),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(null===this.tempCanvasElement){const e=this.canvas.ownerDocument.createElement("canvas");e.width=this.canvas.width,e.height=this.canvas.height,this.tempCanvasElement=e}return this.tempCanvasElement}rotate(e){const t=this.getTempCanvasElement(),a=t.getContext("2d"),n=e*HTMLCanvasElementLuminanceSource.DEGREE_TO_RADIANS,r=this.canvas.width,s=this.canvas.height,i=Math.ceil(Math.abs(Math.cos(n))*r+Math.abs(Math.sin(n))*s),c=Math.ceil(Math.abs(Math.sin(n))*r+Math.abs(Math.cos(n))*s);return t.width=i,t.height=c,a.translate(i/2,c/2),a.rotate(n),a.drawImage(this.canvas,r/-2,s/-2),this.buffer=HTMLCanvasElementLuminanceSource.makeBufferFromCanvasImageData(t),this}invert(){return new InvertedLuminanceSource(this)}}HTMLCanvasElementLuminanceSource.DEGREE_TO_RADIANS=Math.PI/180,HTMLCanvasElementLuminanceSource.FRAME_INDEX=!0;
//# sourceMappingURL=/sm/eadcdb3b10c81c91e3d39adf673b6473494b49611da7796ac075db5890e18b0b.map