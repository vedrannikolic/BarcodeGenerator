/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/@zxing/library@0.21.0/es2015/core/pdf417/decoder/DetectionResult.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import PDF417Common from"../PDF417Common";import Formatter from"../../util/Formatter";export default class DetectionResult{constructor(t,e){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=t,this.barcodeColumnCount=t.getColumnCount(),this.boundingBox=e,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let t,e=PDF417Common.MAX_CODEWORDS_IN_BARCODE;do{t=e,e=this.adjustRowNumbersAndGetCount()}while(e>0&&e<t);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(t){null!=t&&t.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let t=this.adjustRowNumbersByRow();if(0===t)return 0;for(let t=1;t<this.barcodeColumnCount+1;t++){let e=this.detectionResultColumns[t].getCodewords();for(let o=0;o<e.length;o++)null!=e[o]&&(e[o].hasValidRowNumber()||this.adjustRowNumbers(t,o,e))}return t}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(null==this.detectionResultColumns[0]||null==this.detectionResultColumns[this.barcodeColumnCount+1])return;let t=this.detectionResultColumns[0].getCodewords(),e=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let o=0;o<t.length;o++)if(null!=t[o]&&null!=e[o]&&t[o].getRowNumber()===e[o].getRowNumber())for(let e=1;e<=this.barcodeColumnCount;e++){let u=this.detectionResultColumns[e].getCodewords()[o];null!=u&&(u.setRowNumber(t[o].getRowNumber()),u.hasValidRowNumber()||(this.detectionResultColumns[e].getCodewords()[o]=null))}}adjustRowNumbersFromRRI(){if(null==this.detectionResultColumns[this.barcodeColumnCount+1])return 0;let t=0,e=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let o=0;o<e.length;o++){if(null==e[o])continue;let u=e[o].getRowNumber(),s=0;for(let e=this.barcodeColumnCount+1;e>0&&s<this.ADJUST_ROW_NUMBER_SKIP;e--){let n=this.detectionResultColumns[e].getCodewords()[o];null!=n&&(s=DetectionResult.adjustRowNumberIfValid(u,s,n),n.hasValidRowNumber()||t++)}}return t}adjustRowNumbersFromLRI(){if(null==this.detectionResultColumns[0])return 0;let t=0,e=this.detectionResultColumns[0].getCodewords();for(let o=0;o<e.length;o++){if(null==e[o])continue;let u=e[o].getRowNumber(),s=0;for(let e=1;e<this.barcodeColumnCount+1&&s<this.ADJUST_ROW_NUMBER_SKIP;e++){let n=this.detectionResultColumns[e].getCodewords()[o];null!=n&&(s=DetectionResult.adjustRowNumberIfValid(u,s,n),n.hasValidRowNumber()||t++)}}return t}static adjustRowNumberIfValid(t,e,o){return null==o||o.hasValidRowNumber()||(o.isValidRowNumber(t)?(o.setRowNumber(t),e=0):++e),e}adjustRowNumbers(t,e,o){if(null==this.detectionResultColumns[t-1])return;let u=o[e],s=this.detectionResultColumns[t-1].getCodewords(),n=s;null!=this.detectionResultColumns[t+1]&&(n=this.detectionResultColumns[t+1].getCodewords());let l=new Array(14);l[2]=s[e],l[3]=n[e],e>0&&(l[0]=o[e-1],l[4]=s[e-1],l[5]=n[e-1]),e>1&&(l[8]=o[e-2],l[10]=s[e-2],l[11]=n[e-2]),e<o.length-1&&(l[1]=o[e+1],l[6]=s[e+1],l[7]=n[e+1]),e<o.length-2&&(l[9]=o[e+2],l[12]=s[e+2],l[13]=n[e+2]);for(let t of l)if(DetectionResult.adjustRowNumber(u,t))return}static adjustRowNumber(t,e){return null!=e&&(!(!e.hasValidRowNumber()||e.getBucket()!==t.getBucket())&&(t.setRowNumber(e.getRowNumber()),!0))}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(t){this.boundingBox=t}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(t,e){this.detectionResultColumns[t]=e}getDetectionResultColumn(t){return this.detectionResultColumns[t]}toString(){let t=this.detectionResultColumns[0];null==t&&(t=this.detectionResultColumns[this.barcodeColumnCount+1]);let e=new Formatter;for(let o=0;o<t.getCodewords().length;o++){e.format("CW %3d:",o);for(let t=0;t<this.barcodeColumnCount+2;t++){if(null==this.detectionResultColumns[t]){e.format("    |   ");continue}let u=this.detectionResultColumns[t].getCodewords()[o];null!=u?e.format(" %3d|%3d",u.getRowNumber(),u.getValue()):e.format("    |   ")}e.format("%n")}return e.toString()}}
//# sourceMappingURL=/sm/5f87dbed5f99161e8dd7be474ee9783d473061459666b538f4b80cdb8942bd70.map