/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/@zxing/library@0.21.0/es2015/core/pdf417/decoder/DetectionResultRowIndicatorColumn.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import PDF417Common from"../PDF417Common";import BarcodeMetadata from"./BarcodeMetadata";import DetectionResultColumn from"./DetectionResultColumn";import BarcodeValue from"./BarcodeValue";export default class DetectionResultRowIndicatorColumn extends DetectionResultColumn{constructor(e,t){super(e),this._isLeft=t}setRowNumbers(){for(let e of this.getCodewords())null!=e&&e.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(e){let t=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(t,e);let o=this.getBoundingBox(),l=this._isLeft?o.getTopLeft():o.getTopRight(),r=this._isLeft?o.getBottomLeft():o.getBottomRight(),u=this.imageRowToCodewordIndex(Math.trunc(l.getY())),n=this.imageRowToCodewordIndex(Math.trunc(r.getY())),a=-1,s=1,i=0;for(let o=u;o<n;o++){if(null==t[o])continue;let l=t[o],r=l.getRowNumber()-a;if(0===r)i++;else if(1===r)s=Math.max(s,i),i=1,a=l.getRowNumber();else if(r<0||l.getRowNumber()>=e.getRowCount()||r>o)t[o]=null;else{let e;e=s>2?(s-2)*r:r;let u=e>=o;for(let l=1;l<=e&&!u;l++)u=null!=t[o-l];u?t[o]=null:(a=l.getRowNumber(),i=1)}}}getRowHeights(){let e=this.getBarcodeMetadata();if(null==e)return null;this.adjustIncompleteIndicatorColumnRowNumbers(e);let t=new Int32Array(e.getRowCount());for(let e of this.getCodewords())if(null!=e){let o=e.getRowNumber();if(o>=t.length)continue;t[o]++}return t}adjustIncompleteIndicatorColumnRowNumbers(e){let t=this.getBoundingBox(),o=this._isLeft?t.getTopLeft():t.getTopRight(),l=this._isLeft?t.getBottomLeft():t.getBottomRight(),r=this.imageRowToCodewordIndex(Math.trunc(o.getY())),u=this.imageRowToCodewordIndex(Math.trunc(l.getY())),n=this.getCodewords(),a=-1,s=1,i=0;for(let t=r;t<u;t++){if(null==n[t])continue;let o=n[t];o.setRowNumberAsRowIndicatorColumn();let l=o.getRowNumber()-a;0===l?i++:1===l?(s=Math.max(s,i),i=1,a=o.getRowNumber()):o.getRowNumber()>=e.getRowCount()?n[t]=null:(a=o.getRowNumber(),i=1)}}getBarcodeMetadata(){let e=this.getCodewords(),t=new BarcodeValue,o=new BarcodeValue,l=new BarcodeValue,r=new BarcodeValue;for(let u of e){if(null==u)continue;u.setRowNumberAsRowIndicatorColumn();let e=u.getValue()%30,n=u.getRowNumber();switch(this._isLeft||(n+=2),n%3){case 0:o.setValue(3*e+1);break;case 1:r.setValue(e/3),l.setValue(e%3);break;case 2:t.setValue(e+1)}}if(0===t.getValue().length||0===o.getValue().length||0===l.getValue().length||0===r.getValue().length||t.getValue()[0]<1||o.getValue()[0]+l.getValue()[0]<PDF417Common.MIN_ROWS_IN_BARCODE||o.getValue()[0]+l.getValue()[0]>PDF417Common.MAX_ROWS_IN_BARCODE)return null;let u=new BarcodeMetadata(t.getValue()[0],o.getValue()[0],l.getValue()[0],r.getValue()[0]);return this.removeIncorrectCodewords(e,u),u}removeIncorrectCodewords(e,t){for(let o=0;o<e.length;o++){let l=e[o];if(null==e[o])continue;let r=l.getValue()%30,u=l.getRowNumber();if(u>t.getRowCount())e[o]=null;else switch(this._isLeft||(u+=2),u%3){case 0:3*r+1!==t.getRowCountUpperPart()&&(e[o]=null);break;case 1:Math.trunc(r/3)===t.getErrorCorrectionLevel()&&r%3===t.getRowCountLowerPart()||(e[o]=null);break;case 2:r+1!==t.getColumnCount()&&(e[o]=null)}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+"\n"+super.toString()}}
//# sourceMappingURL=/sm/93165f3ef3a4389a85fc1d78c0fdc440b097ea50f46efc9bc6c64b414242f969.map