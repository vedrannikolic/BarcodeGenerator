/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/@zxing/library@0.21.0/cjs/core/oned/ITFReader.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";var __extends=this&&this.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])},e(r,t)};return function(r,t){function n(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),__values=this&&this.__values||function(e){var r="function"==typeof Symbol&&Symbol.iterator,t=r&&e[r],n=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(exports,"__esModule",{value:!0});var BarcodeFormat_1=require("../BarcodeFormat"),DecodeHintType_1=require("../DecodeHintType"),FormatException_1=require("../FormatException"),NotFoundException_1=require("../NotFoundException"),Result_1=require("../Result"),ResultPoint_1=require("../ResultPoint"),StringBuilder_1=require("../util/StringBuilder"),System_1=require("../util/System"),OneDReader_1=require("./OneDReader"),ITFReader=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.narrowLineWidth=-1,r}return __extends(r,e),r.prototype.decodeRow=function(e,t,n){var o,a,i=this.decodeStart(t),u=this.decodeEnd(t),f=new StringBuilder_1.default;r.decodeMiddle(t,i[1],u[0],f);var d=f.toString(),l=null;null!=n&&(l=n.get(DecodeHintType_1.default.ALLOWED_LENGTHS)),null==l&&(l=r.DEFAULT_ALLOWED_LENGTHS);var _=d.length,c=!1,A=0;try{for(var y=__values(l),p=y.next();!p.done;p=y.next()){var s=p.value;if(_===s){c=!0;break}s>A&&(A=s)}}catch(e){o={error:e}}finally{try{p&&!p.done&&(a=y.return)&&a.call(y)}finally{if(o)throw o.error}}if(!c&&_>A&&(c=!0),!c)throw new FormatException_1.default;var E=[new ResultPoint_1.default(i[1],e),new ResultPoint_1.default(u[0],e)];return new Result_1.default(d,null,0,E,BarcodeFormat_1.default.ITF,(new Date).getTime())},r.decodeMiddle=function(e,t,n,o){var a=new Int32Array(10),i=new Int32Array(5),u=new Int32Array(5);for(a.fill(0),i.fill(0),u.fill(0);t<n;){OneDReader_1.default.recordPattern(e,t,a);for(var f=0;f<5;f++){var d=2*f;i[f]=a[d],u[f]=a[d+1]}var l=r.decodeDigit(i);o.append(l.toString()),l=this.decodeDigit(u),o.append(l.toString()),a.forEach((function(e){t+=e}))}},r.prototype.decodeStart=function(e){var t=r.skipWhiteSpace(e),n=r.findGuardPattern(e,t,r.START_PATTERN);return this.narrowLineWidth=(n[1]-n[0])/4,this.validateQuietZone(e,n[0]),n},r.prototype.validateQuietZone=function(e,r){var t=10*this.narrowLineWidth;t=t<r?t:r;for(var n=r-1;t>0&&n>=0&&!e.get(n);n--)t--;if(0!==t)throw new NotFoundException_1.default},r.skipWhiteSpace=function(e){var r=e.getSize(),t=e.getNextSet(0);if(t===r)throw new NotFoundException_1.default;return t},r.prototype.decodeEnd=function(e){e.reverse();try{var t=r.skipWhiteSpace(e),n=void 0;try{n=r.findGuardPattern(e,t,r.END_PATTERN_REVERSED[0])}catch(o){o instanceof NotFoundException_1.default&&(n=r.findGuardPattern(e,t,r.END_PATTERN_REVERSED[1]))}this.validateQuietZone(e,n[0]);var o=n[0];return n[0]=e.getSize()-n[1],n[1]=e.getSize()-o,n}finally{e.reverse()}},r.findGuardPattern=function(e,t,n){var o=n.length,a=new Int32Array(o),i=e.getSize(),u=!1,f=0,d=t;a.fill(0);for(var l=t;l<i;l++)if(e.get(l)!==u)a[f]++;else{if(f===o-1){if(OneDReader_1.default.patternMatchVariance(a,n,r.MAX_INDIVIDUAL_VARIANCE)<r.MAX_AVG_VARIANCE)return[d,l];d+=a[0]+a[1],System_1.default.arraycopy(a,2,a,0,f-1),a[f-1]=0,a[f]=0,f--}else f++;a[f]=1,u=!u}throw new NotFoundException_1.default},r.decodeDigit=function(e){for(var t=r.MAX_AVG_VARIANCE,n=-1,o=r.PATTERNS.length,a=0;a<o;a++){var i=r.PATTERNS[a],u=OneDReader_1.default.patternMatchVariance(e,i,r.MAX_INDIVIDUAL_VARIANCE);u<t?(t=u,n=a):u===t&&(n=-1)}if(n>=0)return n%10;throw new NotFoundException_1.default},r.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],r.MAX_AVG_VARIANCE=.38,r.MAX_INDIVIDUAL_VARIANCE=.5,r.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],r.START_PATTERN=Int32Array.from([1,1,1,1]),r.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])],r}(OneDReader_1.default);exports.default=ITFReader;
//# sourceMappingURL=/sm/6eb5099d2d9e449da69e05ba343877839f0c790d74d83d979a2f37120a3343ba.map