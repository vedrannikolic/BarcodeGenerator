/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/@zxing/library@0.21.0/cjs/core/datamatrix/encoder/HighLevelEncoder.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ASCIIEncoder_1=require("./ASCIIEncoder"),Base256Encoder_1=require("./Base256Encoder"),C40Encoder_1=require("./C40Encoder"),constants_1=require("./constants"),EdifactEncoder_1=require("./EdifactEncoder"),EncoderContext_1=require("./EncoderContext"),X12Encoder_1=require("./X12Encoder"),TextEncoder_1=require("./TextEncoder"),Arrays_1=require("../../util/Arrays"),Integer_1=require("../../util/Integer"),HighLevelEncoder=function(){function t(){}return t.randomize253State=function(t){var n=149*t%253+1,s=constants_1.PAD+n;return s<=254?s:s-254},t.encodeHighLevel=function(t,n,s,e,o){void 0===n&&(n=0),void 0===s&&(s=null),void 0===e&&(e=null),void 0===o&&(o=!1);var r=new C40Encoder_1.C40Encoder,_=[new ASCIIEncoder_1.ASCIIEncoder,r,new TextEncoder_1.TextEncoder,new X12Encoder_1.X12Encoder,new EdifactEncoder_1.EdifactEncoder,new Base256Encoder_1.Base256Encoder],a=new EncoderContext_1.EncoderContext(t);a.setSymbolShape(n),a.setSizeConstraints(s,e),t.startsWith(constants_1.MACRO_05_HEADER)&&t.endsWith(constants_1.MACRO_TRAILER)?(a.writeCodeword(constants_1.MACRO_05),a.setSkipAtEnd(2),a.pos+=constants_1.MACRO_05_HEADER.length):t.startsWith(constants_1.MACRO_06_HEADER)&&t.endsWith(constants_1.MACRO_TRAILER)&&(a.writeCodeword(constants_1.MACRO_06),a.setSkipAtEnd(2),a.pos+=constants_1.MACRO_06_HEADER.length);var A=constants_1.ASCII_ENCODATION;for(o&&(r.encodeMaximal(a),A=a.getNewEncoding(),a.resetEncoderSignal());a.hasMoreCharacters();)_[A].encode(a),a.getNewEncoding()>=0&&(A=a.getNewEncoding(),a.resetEncoderSignal());var C=a.getCodewordCount();a.updateSymbolInfo();var c=a.getSymbolInfo().getDataCapacity();C<c&&A!==constants_1.ASCII_ENCODATION&&A!==constants_1.BASE256_ENCODATION&&A!==constants_1.EDIFACT_ENCODATION&&a.writeCodeword("Ã¾");var i=a.getCodewords();for(i.length()<c&&i.append(constants_1.PAD);i.length()<c;)i.append(this.randomize253State(i.length()+1));return a.getCodewords().toString()},t.lookAheadTest=function(t,n,s){var e=this.lookAheadTestIntern(t,n,s);if(s===constants_1.X12_ENCODATION&&e===constants_1.X12_ENCODATION){for(var o=Math.min(n+3,t.length),r=n;r<o;r++)if(!this.isNativeX12(t.charCodeAt(r)))return constants_1.ASCII_ENCODATION}else if(s===constants_1.EDIFACT_ENCODATION&&e===constants_1.EDIFACT_ENCODATION)for(o=Math.min(n+4,t.length),r=n;r<o;r++)if(!this.isNativeEDIFACT(t.charCodeAt(r)))return constants_1.ASCII_ENCODATION;return e},t.lookAheadTestIntern=function(t,n,s){if(n>=t.length)return s;var e;s===constants_1.ASCII_ENCODATION?e=[0,1,1,1,1,1.25]:(e=[1,2,2,2,2,2.25])[s]=0;for(var o=0,r=new Uint8Array(6),_=[];;){if(n+o===t.length){Arrays_1.default.fill(r,0),Arrays_1.default.fill(_,0);var a=this.findMinimums(e,_,Integer_1.default.MAX_VALUE,r),A=this.getMinimumCount(r);if(_[constants_1.ASCII_ENCODATION]===a)return constants_1.ASCII_ENCODATION;if(1===A){if(r[constants_1.BASE256_ENCODATION]>0)return constants_1.BASE256_ENCODATION;if(r[constants_1.EDIFACT_ENCODATION]>0)return constants_1.EDIFACT_ENCODATION;if(r[constants_1.TEXT_ENCODATION]>0)return constants_1.TEXT_ENCODATION;if(r[constants_1.X12_ENCODATION]>0)return constants_1.X12_ENCODATION}return constants_1.C40_ENCODATION}var C=t.charCodeAt(n+o);if(o++,this.isDigit(C)?e[constants_1.ASCII_ENCODATION]+=.5:this.isExtendedASCII(C)?(e[constants_1.ASCII_ENCODATION]=Math.ceil(e[constants_1.ASCII_ENCODATION]),e[constants_1.ASCII_ENCODATION]+=2):(e[constants_1.ASCII_ENCODATION]=Math.ceil(e[constants_1.ASCII_ENCODATION]),e[constants_1.ASCII_ENCODATION]++),this.isNativeC40(C)?e[constants_1.C40_ENCODATION]+=2/3:this.isExtendedASCII(C)?e[constants_1.C40_ENCODATION]+=8/3:e[constants_1.C40_ENCODATION]+=4/3,this.isNativeText(C)?e[constants_1.TEXT_ENCODATION]+=2/3:this.isExtendedASCII(C)?e[constants_1.TEXT_ENCODATION]+=8/3:e[constants_1.TEXT_ENCODATION]+=4/3,this.isNativeX12(C)?e[constants_1.X12_ENCODATION]+=2/3:this.isExtendedASCII(C)?e[constants_1.X12_ENCODATION]+=13/3:e[constants_1.X12_ENCODATION]+=10/3,this.isNativeEDIFACT(C)?e[constants_1.EDIFACT_ENCODATION]+=3/4:this.isExtendedASCII(C)?e[constants_1.EDIFACT_ENCODATION]+=4.25:e[constants_1.EDIFACT_ENCODATION]+=3.25,this.isSpecialB256(C)?e[constants_1.BASE256_ENCODATION]+=4:e[constants_1.BASE256_ENCODATION]++,o>=4){if(Arrays_1.default.fill(r,0),Arrays_1.default.fill(_,0),this.findMinimums(e,_,Integer_1.default.MAX_VALUE,r),_[constants_1.ASCII_ENCODATION]<this.min(_[constants_1.BASE256_ENCODATION],_[constants_1.C40_ENCODATION],_[constants_1.TEXT_ENCODATION],_[constants_1.X12_ENCODATION],_[constants_1.EDIFACT_ENCODATION]))return constants_1.ASCII_ENCODATION;if(_[constants_1.BASE256_ENCODATION]<_[constants_1.ASCII_ENCODATION]||_[constants_1.BASE256_ENCODATION]+1<this.min(_[constants_1.C40_ENCODATION],_[constants_1.TEXT_ENCODATION],_[constants_1.X12_ENCODATION],_[constants_1.EDIFACT_ENCODATION]))return constants_1.BASE256_ENCODATION;if(_[constants_1.EDIFACT_ENCODATION]+1<this.min(_[constants_1.BASE256_ENCODATION],_[constants_1.C40_ENCODATION],_[constants_1.TEXT_ENCODATION],_[constants_1.X12_ENCODATION],_[constants_1.ASCII_ENCODATION]))return constants_1.EDIFACT_ENCODATION;if(_[constants_1.TEXT_ENCODATION]+1<this.min(_[constants_1.BASE256_ENCODATION],_[constants_1.C40_ENCODATION],_[constants_1.EDIFACT_ENCODATION],_[constants_1.X12_ENCODATION],_[constants_1.ASCII_ENCODATION]))return constants_1.TEXT_ENCODATION;if(_[constants_1.X12_ENCODATION]+1<this.min(_[constants_1.BASE256_ENCODATION],_[constants_1.C40_ENCODATION],_[constants_1.EDIFACT_ENCODATION],_[constants_1.TEXT_ENCODATION],_[constants_1.ASCII_ENCODATION]))return constants_1.X12_ENCODATION;if(_[constants_1.C40_ENCODATION]+1<this.min(_[constants_1.ASCII_ENCODATION],_[constants_1.BASE256_ENCODATION],_[constants_1.EDIFACT_ENCODATION],_[constants_1.TEXT_ENCODATION])){if(_[constants_1.C40_ENCODATION]<_[constants_1.X12_ENCODATION])return constants_1.C40_ENCODATION;if(_[constants_1.C40_ENCODATION]===_[constants_1.X12_ENCODATION]){for(var c=n+o+1;c<t.length;){var i=t.charCodeAt(c);if(this.isX12TermSep(i))return constants_1.X12_ENCODATION;if(!this.isNativeX12(i))break;c++}return constants_1.C40_ENCODATION}}}}},t.min=function(t,n,s,e,o){var r=Math.min(t,Math.min(n,Math.min(s,e)));return void 0===o?r:Math.min(r,o)},t.findMinimums=function(t,n,s,e){for(var o=0;o<6;o++){var r=n[o]=Math.ceil(t[o]);s>r&&(s=r,Arrays_1.default.fill(e,0)),s===r&&(e[o]=e[o]+1)}return s},t.getMinimumCount=function(t){for(var n=0,s=0;s<6;s++)n+=t[s];return n||0},t.isDigit=function(t){return t>="0".charCodeAt(0)&&t<="9".charCodeAt(0)},t.isExtendedASCII=function(t){return t>=128&&t<=255},t.isNativeC40=function(t){return t===" ".charCodeAt(0)||t>="0".charCodeAt(0)&&t<="9".charCodeAt(0)||t>="A".charCodeAt(0)&&t<="Z".charCodeAt(0)},t.isNativeText=function(t){return t===" ".charCodeAt(0)||t>="0".charCodeAt(0)&&t<="9".charCodeAt(0)||t>="a".charCodeAt(0)&&t<="z".charCodeAt(0)},t.isNativeX12=function(t){return this.isX12TermSep(t)||t===" ".charCodeAt(0)||t>="0".charCodeAt(0)&&t<="9".charCodeAt(0)||t>="A".charCodeAt(0)&&t<="Z".charCodeAt(0)},t.isX12TermSep=function(t){return 13===t||t==="*".charCodeAt(0)||t===">".charCodeAt(0)},t.isNativeEDIFACT=function(t){return t>=" ".charCodeAt(0)&&t<="^".charCodeAt(0)},t.isSpecialB256=function(t){return!1},t.determineConsecutiveDigitCount=function(t,n){void 0===n&&(n=0);for(var s=t.length,e=n;e<s&&this.isDigit(t.charCodeAt(e));)e++;return e-n},t.illegalCharacter=function(t){var n=Integer_1.default.toHexString(t.charCodeAt(0));throw n="0000".substring(0,4-n.length)+n,new Error("Illegal character: "+t+" (0x"+n+")")},t}();exports.default=HighLevelEncoder;
//# sourceMappingURL=/sm/d464d4538694568958cd0d15d5bc93bc1c5c426c084f2bdeee6efb8c4ba68ea5.map