/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/@zxing/library@0.21.0/cjs/core/datamatrix/decoder/BitMatrixParser.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var BitMatrix_1=require("../../common/BitMatrix"),Version_1=require("./Version"),FormatException_1=require("../../FormatException"),IllegalArgumentException_1=require("../../IllegalArgumentException"),BitMatrixParser=function(){function e(t){var r=t.getHeight();if(r<8||r>144||0!=(1&r))throw new FormatException_1.default;this.version=e.readVersion(t),this.mappingBitMatrix=this.extractDataRegion(t),this.readMappingMatrix=new BitMatrix_1.default(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}return e.prototype.getVersion=function(){return this.version},e.readVersion=function(e){var t=e.getHeight(),r=e.getWidth();return Version_1.default.getVersionForDimensions(t,r)},e.prototype.readCodewords=function(){var e=new Int8Array(this.version.getTotalCodewords()),t=0,r=4,i=0,o=this.mappingBitMatrix.getHeight(),a=this.mappingBitMatrix.getWidth(),d=!1,s=!1,n=!1,h=!1;do{if(r!==o||0!==i||d)if(r!==o-2||0!==i||0==(3&a)||s)if(r!==o+4||2!==i||0!=(7&a)||n)if(r!==o-2||0!==i||4!=(7&a)||h){do{r<o&&i>=0&&!this.readMappingMatrix.get(i,r)&&(e[t++]=255&this.readUtah(r,i,o,a)),r-=2,i+=2}while(r>=0&&i<a);r+=1,i+=3;do{r>=0&&i<a&&!this.readMappingMatrix.get(i,r)&&(e[t++]=255&this.readUtah(r,i,o,a)),r+=2,i-=2}while(r<o&&i>=0);r+=3,i+=1}else e[t++]=255&this.readCorner4(o,a),r-=2,i+=2,h=!0;else e[t++]=255&this.readCorner3(o,a),r-=2,i+=2,n=!0;else e[t++]=255&this.readCorner2(o,a),r-=2,i+=2,s=!0;else e[t++]=255&this.readCorner1(o,a),r-=2,i+=2,d=!0}while(r<o||i<a);if(t!==this.version.getTotalCodewords())throw new FormatException_1.default;return e},e.prototype.readModule=function(e,t,r,i){return e<0&&(e+=r,t+=4-(r+4&7)),t<0&&(t+=i,e+=4-(i+4&7)),this.readMappingMatrix.set(t,e),this.mappingBitMatrix.get(t,e)},e.prototype.readUtah=function(e,t,r,i){var o=0;return this.readModule(e-2,t-2,r,i)&&(o|=1),o<<=1,this.readModule(e-2,t-1,r,i)&&(o|=1),o<<=1,this.readModule(e-1,t-2,r,i)&&(o|=1),o<<=1,this.readModule(e-1,t-1,r,i)&&(o|=1),o<<=1,this.readModule(e-1,t,r,i)&&(o|=1),o<<=1,this.readModule(e,t-2,r,i)&&(o|=1),o<<=1,this.readModule(e,t-1,r,i)&&(o|=1),o<<=1,this.readModule(e,t,r,i)&&(o|=1),o},e.prototype.readCorner1=function(e,t){var r=0;return this.readModule(e-1,0,e,t)&&(r|=1),r<<=1,this.readModule(e-1,1,e,t)&&(r|=1),r<<=1,this.readModule(e-1,2,e,t)&&(r|=1),r<<=1,this.readModule(0,t-2,e,t)&&(r|=1),r<<=1,this.readModule(0,t-1,e,t)&&(r|=1),r<<=1,this.readModule(1,t-1,e,t)&&(r|=1),r<<=1,this.readModule(2,t-1,e,t)&&(r|=1),r<<=1,this.readModule(3,t-1,e,t)&&(r|=1),r},e.prototype.readCorner2=function(e,t){var r=0;return this.readModule(e-3,0,e,t)&&(r|=1),r<<=1,this.readModule(e-2,0,e,t)&&(r|=1),r<<=1,this.readModule(e-1,0,e,t)&&(r|=1),r<<=1,this.readModule(0,t-4,e,t)&&(r|=1),r<<=1,this.readModule(0,t-3,e,t)&&(r|=1),r<<=1,this.readModule(0,t-2,e,t)&&(r|=1),r<<=1,this.readModule(0,t-1,e,t)&&(r|=1),r<<=1,this.readModule(1,t-1,e,t)&&(r|=1),r},e.prototype.readCorner3=function(e,t){var r=0;return this.readModule(e-1,0,e,t)&&(r|=1),r<<=1,this.readModule(e-1,t-1,e,t)&&(r|=1),r<<=1,this.readModule(0,t-3,e,t)&&(r|=1),r<<=1,this.readModule(0,t-2,e,t)&&(r|=1),r<<=1,this.readModule(0,t-1,e,t)&&(r|=1),r<<=1,this.readModule(1,t-3,e,t)&&(r|=1),r<<=1,this.readModule(1,t-2,e,t)&&(r|=1),r<<=1,this.readModule(1,t-1,e,t)&&(r|=1),r},e.prototype.readCorner4=function(e,t){var r=0;return this.readModule(e-3,0,e,t)&&(r|=1),r<<=1,this.readModule(e-2,0,e,t)&&(r|=1),r<<=1,this.readModule(e-1,0,e,t)&&(r|=1),r<<=1,this.readModule(0,t-2,e,t)&&(r|=1),r<<=1,this.readModule(0,t-1,e,t)&&(r|=1),r<<=1,this.readModule(1,t-1,e,t)&&(r|=1),r<<=1,this.readModule(2,t-1,e,t)&&(r|=1),r<<=1,this.readModule(3,t-1,e,t)&&(r|=1),r},e.prototype.extractDataRegion=function(e){var t=this.version.getSymbolSizeRows(),r=this.version.getSymbolSizeColumns();if(e.getHeight()!==t)throw new IllegalArgumentException_1.default("Dimension of bitMatrix must match the version size");for(var i=this.version.getDataRegionSizeRows(),o=this.version.getDataRegionSizeColumns(),a=t/i|0,d=r/o|0,s=a*i,n=d*o,h=new BitMatrix_1.default(n,s),u=0;u<a;++u)for(var l=u*i,M=0;M<d;++M)for(var p=M*o,g=0;g<i;++g)for(var f=u*(i+2)+1+g,x=l+g,v=0;v<o;++v){var c=M*(o+2)+1+v;if(e.get(c,f)){var m=p+v;h.set(m,x)}}return h},e}();exports.default=BitMatrixParser;
//# sourceMappingURL=/sm/e30addbdbb92c5cc0cf37a4ef667a0d2ef92512a8429be0e5990606d4462ef82.map