/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/@zxing/library@0.21.0/cjs/core/datamatrix/encoder/EdifactEncoder.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EdifactEncoder=void 0;var StringUtils_1=require("../../common/StringUtils"),StringBuilder_1=require("../../util/StringBuilder"),constants_1=require("./constants"),HighLevelEncoder_1=require("./HighLevelEncoder"),EdifactEncoder=function(){function e(){}return e.prototype.getEncodingMode=function(){return constants_1.EDIFACT_ENCODATION},e.prototype.encode=function(e){for(var t=new StringBuilder_1.default;e.hasMoreCharacters();){var o=e.getCurrentChar();if(this.encodeChar(o,t),e.pos++,t.length()>=4){e.writeCodewords(this.encodeToCodewords(t.toString()));var r=t.toString().substring(4);if(t.setLengthToZero(),t.append(r),HighLevelEncoder_1.default.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode())!==this.getEncodingMode()){e.signalEncoderChange(constants_1.ASCII_ENCODATION);break}}}t.append(StringUtils_1.default.getCharAt(31)),this.handleEOD(e,t)},e.prototype.handleEOD=function(e,t){try{var o=t.length();if(0===o)return;if(1===o){e.updateSymbolInfo();var r=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount(),n=e.getRemainingCharacters();if(n>r&&(e.updateSymbolInfo(e.getCodewordCount()+1),r=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount()),n<=r&&r<=2)return}if(o>4)throw new Error("Count must not exceed 4");var a=o-1,d=this.encodeToCodewords(t.toString()),i=!e.hasMoreCharacters()&&a<=2;if(a<=2)e.updateSymbolInfo(e.getCodewordCount()+a),(r=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount())>=3&&(i=!1,e.updateSymbolInfo(e.getCodewordCount()+d.length));i?(e.resetSymbolInfo(),e.pos-=a):e.writeCodewords(d)}finally{e.signalEncoderChange(constants_1.ASCII_ENCODATION)}},e.prototype.encodeChar=function(e,t){e>=" ".charCodeAt(0)&&e<="?".charCodeAt(0)?t.append(e):e>="@".charCodeAt(0)&&e<="^".charCodeAt(0)?t.append(StringUtils_1.default.getCharAt(e-64)):HighLevelEncoder_1.default.illegalCharacter(StringUtils_1.default.getCharAt(e))},e.prototype.encodeToCodewords=function(e){var t=e.length;if(0===t)throw new Error("StringBuilder must not be empty");var o=(e.charAt(0).charCodeAt(0)<<18)+((t>=2?e.charAt(1).charCodeAt(0):0)<<12)+((t>=3?e.charAt(2).charCodeAt(0):0)<<6)+(t>=4?e.charAt(3).charCodeAt(0):0),r=o>>16&255,n=o>>8&255,a=255&o,d=new StringBuilder_1.default;return d.append(r),t>=2&&d.append(n),t>=3&&d.append(a),d.toString()},e}();exports.EdifactEncoder=EdifactEncoder;
//# sourceMappingURL=/sm/6d05633e9b4180e9e1d185c9639ea8e7575a9ae9285e11dbdeb383622c96d9ad.map