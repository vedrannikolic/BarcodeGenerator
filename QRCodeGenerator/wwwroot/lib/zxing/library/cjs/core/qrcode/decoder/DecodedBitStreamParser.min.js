/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/@zxing/library@0.21.0/cjs/core/qrcode/decoder/DecodedBitStreamParser.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var BitSource_1=require("../../common/BitSource"),CharacterSetECI_1=require("../../common/CharacterSetECI"),DecoderResult_1=require("../../common/DecoderResult"),StringUtils_1=require("../../common/StringUtils"),FormatException_1=require("../../FormatException"),StringBuilder_1=require("../../util/StringBuilder"),StringEncoding_1=require("../../util/StringEncoding"),Mode_1=require("./Mode"),DecodedBitStreamParser=function(){function e(){}return e.decode=function(t,a,r,o){var i=new BitSource_1.default(t),n=new StringBuilder_1.default,d=new Array,l=-1,u=-1;try{var c=null,f=!1,h=void 0;do{if(i.available()<4)h=Mode_1.default.TERMINATOR;else{var p=i.readBits(4);h=Mode_1.default.forBits(p)}switch(h){case Mode_1.default.TERMINATOR:break;case Mode_1.default.FNC1_FIRST_POSITION:case Mode_1.default.FNC1_SECOND_POSITION:f=!0;break;case Mode_1.default.STRUCTURED_APPEND:if(i.available()<16)throw new FormatException_1.default;l=i.readBits(8),u=i.readBits(8);break;case Mode_1.default.ECI:var _=e.parseECIValue(i);if(null===(c=CharacterSetECI_1.default.getCharacterSetECIByValue(_)))throw new FormatException_1.default;break;case Mode_1.default.HANZI:var m=i.readBits(4),s=i.readBits(h.getCharacterCountBits(a));m===e.GB2312_SUBSET&&e.decodeHanziSegment(i,n,s);break;default:var w=i.readBits(h.getCharacterCountBits(a));switch(h){case Mode_1.default.NUMERIC:e.decodeNumericSegment(i,n,w);break;case Mode_1.default.ALPHANUMERIC:e.decodeAlphanumericSegment(i,n,w,f);break;case Mode_1.default.BYTE:e.decodeByteSegment(i,n,w,c,d,o);break;case Mode_1.default.KANJI:e.decodeKanjiSegment(i,n,w);break;default:throw new FormatException_1.default}}}while(h!==Mode_1.default.TERMINATOR)}catch(e){throw new FormatException_1.default}return new DecoderResult_1.default(t,n.toString(),0===d.length?null:d,null===r?null:r.toString(),l,u)},e.decodeHanziSegment=function(e,t,a){if(13*a>e.available())throw new FormatException_1.default;for(var r=new Uint8Array(2*a),o=0;a>0;){var i=e.readBits(13),n=i/96<<8&4294967295|i%96;n+=n<959?41377:42657,r[o]=n>>8&255,r[o+1]=255&n,o+=2,a--}try{t.append(StringEncoding_1.default.decode(r,StringUtils_1.default.GB2312))}catch(e){throw new FormatException_1.default(e)}},e.decodeKanjiSegment=function(e,t,a){if(13*a>e.available())throw new FormatException_1.default;for(var r=new Uint8Array(2*a),o=0;a>0;){var i=e.readBits(13),n=i/192<<8&4294967295|i%192;n+=n<7936?33088:49472,r[o]=n>>8,r[o+1]=n,o+=2,a--}try{t.append(StringEncoding_1.default.decode(r,StringUtils_1.default.SHIFT_JIS))}catch(e){throw new FormatException_1.default(e)}},e.decodeByteSegment=function(e,t,a,r,o,i){if(8*a>e.available())throw new FormatException_1.default;for(var n,d=new Uint8Array(a),l=0;l<a;l++)d[l]=e.readBits(8);n=null===r?StringUtils_1.default.guessEncoding(d,i):r.getName();try{t.append(StringEncoding_1.default.decode(d,n))}catch(e){throw new FormatException_1.default(e)}o.push(d)},e.toAlphaNumericChar=function(t){if(t>=e.ALPHANUMERIC_CHARS.length)throw new FormatException_1.default;return e.ALPHANUMERIC_CHARS[t]},e.decodeAlphanumericSegment=function(t,a,r,o){for(var i=a.length();r>1;){if(t.available()<11)throw new FormatException_1.default;var n=t.readBits(11);a.append(e.toAlphaNumericChar(Math.floor(n/45))),a.append(e.toAlphaNumericChar(n%45)),r-=2}if(1===r){if(t.available()<6)throw new FormatException_1.default;a.append(e.toAlphaNumericChar(t.readBits(6)))}if(o)for(var d=i;d<a.length();d++)"%"===a.charAt(d)&&(d<a.length()-1&&"%"===a.charAt(d+1)?a.deleteCharAt(d+1):a.setCharAt(d,String.fromCharCode(29)))},e.decodeNumericSegment=function(t,a,r){for(;r>=3;){if(t.available()<10)throw new FormatException_1.default;var o=t.readBits(10);if(o>=1e3)throw new FormatException_1.default;a.append(e.toAlphaNumericChar(Math.floor(o/100))),a.append(e.toAlphaNumericChar(Math.floor(o/10)%10)),a.append(e.toAlphaNumericChar(o%10)),r-=3}if(2===r){if(t.available()<7)throw new FormatException_1.default;var i=t.readBits(7);if(i>=100)throw new FormatException_1.default;a.append(e.toAlphaNumericChar(Math.floor(i/10))),a.append(e.toAlphaNumericChar(i%10))}else if(1===r){if(t.available()<4)throw new FormatException_1.default;var n=t.readBits(4);if(n>=10)throw new FormatException_1.default;a.append(e.toAlphaNumericChar(n))}},e.parseECIValue=function(e){var t=e.readBits(8);if(0==(128&t))return 127&t;if(128==(192&t))return(63&t)<<8&4294967295|e.readBits(8);if(192==(224&t))return(31&t)<<16&4294967295|e.readBits(16);throw new FormatException_1.default},e.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",e.GB2312_SUBSET=1,e}();exports.default=DecodedBitStreamParser;
//# sourceMappingURL=/sm/bd85070b7c59def1baa7492937ecf1c54d55a210014eef53584d1822ef085768.map