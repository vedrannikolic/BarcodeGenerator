/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/@zxing/library@0.21.0/cjs/core/qrcode/decoder/BitMatrixParser.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Version_1=require("./Version"),FormatInformation_1=require("./FormatInformation"),DataMask_1=require("./DataMask"),FormatException_1=require("../../FormatException"),BitMatrixParser=function(){function t(t){var r=t.getHeight();if(r<21||1!=(3&r))throw new FormatException_1.default;this.bitMatrix=t}return t.prototype.readFormatInformation=function(){if(null!==this.parsedFormatInfo&&void 0!==this.parsedFormatInfo)return this.parsedFormatInfo;for(var t=0,r=0;r<6;r++)t=this.copyBit(r,8,t);t=this.copyBit(7,8,t),t=this.copyBit(8,8,t),t=this.copyBit(8,7,t);for(var i=5;i>=0;i--)t=this.copyBit(8,i,t);var o=this.bitMatrix.getHeight(),e=0,a=o-7;for(i=o-1;i>=a;i--)e=this.copyBit(8,i,e);for(r=o-8;r<o;r++)e=this.copyBit(r,8,e);if(this.parsedFormatInfo=FormatInformation_1.default.decodeFormatInformation(t,e),null!==this.parsedFormatInfo)return this.parsedFormatInfo;throw new FormatException_1.default},t.prototype.readVersion=function(){if(null!==this.parsedVersion&&void 0!==this.parsedVersion)return this.parsedVersion;var t=this.bitMatrix.getHeight(),r=Math.floor((t-17)/4);if(r<=6)return Version_1.default.getVersionForNumber(r);for(var i=0,o=t-11,e=5;e>=0;e--)for(var a=t-9;a>=o;a--)i=this.copyBit(a,e,i);var n=Version_1.default.decodeVersionInformation(i);if(null!==n&&n.getDimensionForVersion()===t)return this.parsedVersion=n,n;i=0;for(a=5;a>=0;a--)for(e=t-9;e>=o;e--)i=this.copyBit(a,e,i);if(null!==(n=Version_1.default.decodeVersionInformation(i))&&n.getDimensionForVersion()===t)return this.parsedVersion=n,n;throw new FormatException_1.default},t.prototype.copyBit=function(t,r,i){return(this.isMirror?this.bitMatrix.get(r,t):this.bitMatrix.get(t,r))?i<<1|1:i<<1},t.prototype.readCodewords=function(){var t=this.readFormatInformation(),r=this.readVersion(),i=DataMask_1.default.values.get(t.getDataMask()),o=this.bitMatrix.getHeight();i.unmaskBitMatrix(this.bitMatrix,o);for(var e=r.buildFunctionPattern(),a=!0,n=new Uint8Array(r.getTotalCodewords()),s=0,f=0,h=0,u=o-1;u>0;u-=2){6===u&&u--;for(var p=0;p<o;p++)for(var d=a?o-1-p:p,l=0;l<2;l++)e.get(u-l,d)||(h++,f<<=1,this.bitMatrix.get(u-l,d)&&(f|=1),8===h&&(n[s++]=f,h=0,f=0));a=!a}if(s!==r.getTotalCodewords())throw new FormatException_1.default;return n},t.prototype.remask=function(){if(null!==this.parsedFormatInfo){var t=DataMask_1.default.values[this.parsedFormatInfo.getDataMask()],r=this.bitMatrix.getHeight();t.unmaskBitMatrix(this.bitMatrix,r)}},t.prototype.setMirror=function(t){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=t},t.prototype.mirror=function(){for(var t=this.bitMatrix,r=0,i=t.getWidth();r<i;r++)for(var o=r+1,e=t.getHeight();o<e;o++)t.get(r,o)!==t.get(o,r)&&(t.flip(o,r),t.flip(r,o))},t}();exports.default=BitMatrixParser;
//# sourceMappingURL=/sm/ae812bc237c323d5b72d2ec5bddc1dd84c5c811158c6682e40285502a5e0cf6c.map