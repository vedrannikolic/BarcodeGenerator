/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/@zxing/library@0.21.0/cjs/core/qrcode/QRCodeReader.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var BarcodeFormat_1=require("../BarcodeFormat"),BitMatrix_1=require("../common/BitMatrix"),DecodeHintType_1=require("../DecodeHintType"),NotFoundException_1=require("../NotFoundException"),Result_1=require("../Result"),ResultMetadataType_1=require("../ResultMetadataType"),Decoder_1=require("./decoder/Decoder"),QRCodeDecoderMetaData_1=require("./decoder/QRCodeDecoderMetaData"),Detector_1=require("./detector/Detector"),QRCodeReader=function(){function e(){this.decoder=new Decoder_1.default}return e.prototype.getDecoder=function(){return this.decoder},e.prototype.decode=function(t,r){var o,a;if(null!=r&&void 0!==r.get(DecodeHintType_1.default.PURE_BARCODE)){var d=e.extractPureBits(t.getBlackMatrix());o=this.decoder.decodeBitMatrix(d,r),a=e.NO_POINTS}else{var u=new Detector_1.default(t.getBlackMatrix()).detect(r);o=this.decoder.decodeBitMatrix(u.getBits(),r),a=u.getPoints()}o.getOther()instanceof QRCodeDecoderMetaData_1.default&&o.getOther().applyMirroredCorrection(a);var i=new Result_1.default(o.getText(),o.getRawBytes(),void 0,a,BarcodeFormat_1.default.QR_CODE,void 0),n=o.getByteSegments();null!==n&&i.putMetadata(ResultMetadataType_1.default.BYTE_SEGMENTS,n);var c=o.getECLevel();return null!==c&&i.putMetadata(ResultMetadataType_1.default.ERROR_CORRECTION_LEVEL,c),o.hasStructuredAppend()&&(i.putMetadata(ResultMetadataType_1.default.STRUCTURED_APPEND_SEQUENCE,o.getStructuredAppendSequenceNumber()),i.putMetadata(ResultMetadataType_1.default.STRUCTURED_APPEND_PARITY,o.getStructuredAppendParity())),i},e.prototype.reset=function(){},e.extractPureBits=function(e){var t=e.getTopLeftOnBit(),r=e.getBottomRightOnBit();if(null===t||null===r)throw new NotFoundException_1.default;var o=this.moduleSize(t,e),a=t[1],d=r[1],u=t[0],i=r[0];if(u>=i||a>=d)throw new NotFoundException_1.default;if(d-a!=i-u&&(i=u+(d-a))>=e.getWidth())throw new NotFoundException_1.default;var n=Math.round((i-u+1)/o),c=Math.round((d-a+1)/o);if(n<=0||c<=0)throw new NotFoundException_1.default;if(c!==n)throw new NotFoundException_1.default;var l=Math.floor(o/2);a+=l;var f=(u+=l)+Math.floor((n-1)*o)-i;if(f>0){if(f>l)throw new NotFoundException_1.default;u-=f}var p=a+Math.floor((c-1)*o)-d;if(p>0){if(p>l)throw new NotFoundException_1.default;a-=p}for(var _=new BitMatrix_1.default(n,c),R=0;R<c;R++)for(var s=a+Math.floor(R*o),M=0;M<n;M++)e.get(u+Math.floor(M*o),s)&&_.set(M,R);return _},e.moduleSize=function(e,t){for(var r=t.getHeight(),o=t.getWidth(),a=e[0],d=e[1],u=!0,i=0;a<o&&d<r;){if(u!==t.get(a,d)){if(5==++i)break;u=!u}a++,d++}if(a===o||d===r)throw new NotFoundException_1.default;return(a-e[0])/7},e.NO_POINTS=new Array,e}();exports.default=QRCodeReader;
//# sourceMappingURL=/sm/4bf00468a824390ea39ef7ca5e9224b3517f68d3a1b39f270ee22724aee783c1.map