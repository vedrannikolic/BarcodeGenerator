/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/@zxing/library@0.21.0/cjs/core/aztec/encoder/Encoder.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";var __values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(exports,"__esModule",{value:!0});var BitArray_1=require("../../common/BitArray"),IllegalArgumentException_1=require("../../IllegalArgumentException"),StringUtils_1=require("../../common/StringUtils"),BitMatrix_1=require("../../common/BitMatrix"),AztecCode_1=require("./AztecCode"),ReedSolomonEncoder_1=require("../../common/reedsolomon/ReedSolomonEncoder"),GenericGF_1=require("../../common/reedsolomon/GenericGF"),HighLevelEncoder_1=require("./HighLevelEncoder"),Integer_1=require("../../util/Integer"),Encoder=function(){function e(){}return e.encodeBytes=function(t){return e.encode(t,e.DEFAULT_EC_PERCENT,e.DEFAULT_AZTEC_LAYERS)},e.encode=function(t,r,n){var i,o,a,s,u,l=new HighLevelEncoder_1.default(t).encode(),f=Integer_1.default.truncDivision(l.getSize()*r,100)+11,d=l.getSize()+f;if(n!==e.DEFAULT_AZTEC_LAYERS){if(i=n<0,(o=Math.abs(n))>(i?e.MAX_NB_BITS_COMPACT:e.MAX_NB_BITS))throw new IllegalArgumentException_1.default(StringUtils_1.default.format("Illegal value %s for layers",n));var c=(a=e.totalBitsInLayer(o,i))-a%(s=e.WORD_SIZE[o]);if((u=e.stuffBits(l,s)).getSize()+f>c)throw new IllegalArgumentException_1.default("Data to large for user specified layer");if(i&&u.getSize()>64*s)throw new IllegalArgumentException_1.default("Data to large for user specified layer")}else{s=0,u=null;for(var _=0;;_++){if(_>e.MAX_NB_BITS)throw new IllegalArgumentException_1.default("Data too large for an Aztec code");if(o=(i=_<=3)?_+1:_,!(d>(a=e.totalBitsInLayer(o,i)))){null!=u&&s===e.WORD_SIZE[o]||(s=e.WORD_SIZE[o],u=e.stuffBits(l,s));c=a-a%s;if(!(i&&u.getSize()>64*s)&&u.getSize()+f<=c)break}}}var g,v=e.generateCheckWords(u,a,s),A=u.getSize()/s,E=e.generateModeMessage(i,o,A),I=(i?11:14)+4*o,B=new Int32Array(I);if(i){g=I;for(_=0;_<B.length;_++)B[_]=_}else{g=I+1+2*Integer_1.default.truncDivision(Integer_1.default.truncDivision(I,2)-1,15);var p=Integer_1.default.truncDivision(I,2),D=Integer_1.default.truncDivision(g,2);for(_=0;_<p;_++){var S=_+Integer_1.default.truncDivision(_,15);B[p-_-1]=D-S-1,B[p+_]=D+S+1}}for(var y=new BitMatrix_1.default(g),m=(_=0,0);_<o;_++){for(var w=4*(o-_)+(i?9:12),T=0;T<w;T++)for(var C=2*T,h=0;h<2;h++)v.get(m+C+h)&&y.set(B[2*_+h],B[2*_+T]),v.get(m+2*w+C+h)&&y.set(B[2*_+T],B[I-1-2*_-h]),v.get(m+4*w+C+h)&&y.set(B[I-1-2*_-h],B[I-1-2*_-T]),v.get(m+6*w+C+h)&&y.set(B[I-1-2*_-T],B[2*_+h]);m+=8*w}if(e.drawModeMessage(y,i,g,E),i)e.drawBullsEye(y,Integer_1.default.truncDivision(g,2),5);else{e.drawBullsEye(y,Integer_1.default.truncDivision(g,2),7);for(_=0,T=0;_<Integer_1.default.truncDivision(I,2)-1;_+=15,T+=16)for(h=1&Integer_1.default.truncDivision(g,2);h<g;h+=2)y.set(Integer_1.default.truncDivision(g,2)-T,h),y.set(Integer_1.default.truncDivision(g,2)+T,h),y.set(h,Integer_1.default.truncDivision(g,2)-T),y.set(h,Integer_1.default.truncDivision(g,2)+T)}var M=new AztecCode_1.default;return M.setCompact(i),M.setSize(g),M.setLayers(o),M.setCodeWords(A),M.setMatrix(y),M},e.drawBullsEye=function(e,t,r){for(var n=0;n<r;n+=2)for(var i=t-n;i<=t+n;i++)e.set(i,t-n),e.set(i,t+n),e.set(t-n,i),e.set(t+n,i);e.set(t-r,t-r),e.set(t-r+1,t-r),e.set(t-r,t-r+1),e.set(t+r,t-r),e.set(t+r,t-r+1),e.set(t+r,t+r-1)},e.generateModeMessage=function(t,r,n){var i=new BitArray_1.default;return t?(i.appendBits(r-1,2),i.appendBits(n-1,6),i=e.generateCheckWords(i,28,4)):(i.appendBits(r-1,5),i.appendBits(n-1,11),i=e.generateCheckWords(i,40,4)),i},e.drawModeMessage=function(e,t,r,n){var i=Integer_1.default.truncDivision(r,2);if(t)for(var o=0;o<7;o++){var a=i-3+o;n.get(o)&&e.set(a,i-5),n.get(o+7)&&e.set(i+5,a),n.get(20-o)&&e.set(a,i+5),n.get(27-o)&&e.set(i-5,a)}else for(o=0;o<10;o++){a=i-5+o+Integer_1.default.truncDivision(o,5);n.get(o)&&e.set(a,i-7),n.get(o+10)&&e.set(i+7,a),n.get(29-o)&&e.set(a,i+7),n.get(39-o)&&e.set(i-7,a)}},e.generateCheckWords=function(t,r,n){var i,o,a=t.getSize()/n,s=new ReedSolomonEncoder_1.default(e.getGF(n)),u=Integer_1.default.truncDivision(r,n),l=e.bitsToWords(t,n,u);s.encode(l,u-a);var f=r%n,d=new BitArray_1.default;d.appendBits(0,f);try{for(var c=__values(Array.from(l)),_=c.next();!_.done;_=c.next()){var g=_.value;d.appendBits(g,n)}}catch(e){i={error:e}}finally{try{_&&!_.done&&(o=c.return)&&o.call(c)}finally{if(i)throw i.error}}return d},e.bitsToWords=function(e,t,r){var n,i,o=new Int32Array(r);for(n=0,i=e.getSize()/t;n<i;n++){for(var a=0,s=0;s<t;s++)a|=e.get(n*t+s)?1<<t-s-1:0;o[n]=a}return o},e.getGF=function(e){switch(e){case 4:return GenericGF_1.default.AZTEC_PARAM;case 6:return GenericGF_1.default.AZTEC_DATA_6;case 8:return GenericGF_1.default.AZTEC_DATA_8;case 10:return GenericGF_1.default.AZTEC_DATA_10;case 12:return GenericGF_1.default.AZTEC_DATA_12;default:throw new IllegalArgumentException_1.default("Unsupported word size "+e)}},e.stuffBits=function(e,t){for(var r=new BitArray_1.default,n=e.getSize(),i=(1<<t)-2,o=0;o<n;o+=t){for(var a=0,s=0;s<t;s++)(o+s>=n||e.get(o+s))&&(a|=1<<t-1-s);(a&i)===i?(r.appendBits(a&i,t),o--):0==(a&i)?(r.appendBits(1|a,t),o--):r.appendBits(a,t)}return r},e.totalBitsInLayer=function(e,t){return((t?88:112)+16*e)*e},e.DEFAULT_EC_PERCENT=33,e.DEFAULT_AZTEC_LAYERS=0,e.MAX_NB_BITS=32,e.MAX_NB_BITS_COMPACT=4,e.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]),e}();exports.default=Encoder;
//# sourceMappingURL=/sm/4c9896991da92116fd3f2839ab7c39e058e960d0bbebb85a9bc8e70e0d3416f3.map