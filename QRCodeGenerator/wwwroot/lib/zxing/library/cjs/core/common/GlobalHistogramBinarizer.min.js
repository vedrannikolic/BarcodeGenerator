/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/@zxing/library@0.21.0/cjs/core/common/GlobalHistogramBinarizer.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";var __extends=this&&this.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])},t(r,e)};return function(r,e){function i(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();Object.defineProperty(exports,"__esModule",{value:!0});var Binarizer_1=require("../Binarizer"),BitArray_1=require("./BitArray"),BitMatrix_1=require("./BitMatrix"),NotFoundException_1=require("../NotFoundException"),GlobalHistogramBinarizer=function(t){function r(e){var i=t.call(this,e)||this;return i.luminances=r.EMPTY,i.buckets=new Int32Array(r.LUMINANCE_BUCKETS),i}return __extends(r,t),r.prototype.getBlackRow=function(t,e){var i=this.getLuminanceSource(),n=i.getWidth();null==e||e.getSize()<n?e=new BitArray_1.default(n):e.clear(),this.initArrays(n);for(var o=i.getRow(t,this.luminances),a=this.buckets,u=0;u<n;u++)a[(255&o[u])>>r.LUMINANCE_SHIFT]++;var s=r.estimateBlackPoint(a);if(n<3)for(u=0;u<n;u++)(255&o[u])<s&&e.set(u);else{var c=255&o[0],f=255&o[1];for(u=1;u<n-1;u++){var l=255&o[u+1];(4*f-c-l)/2<s&&e.set(u),c=f,f=l}}return e},r.prototype.getBlackMatrix=function(){var t=this.getLuminanceSource(),e=t.getWidth(),i=t.getHeight(),n=new BitMatrix_1.default(e,i);this.initArrays(e);for(var o=this.buckets,a=1;a<5;a++)for(var u=Math.floor(i*a/5),s=t.getRow(u,this.luminances),c=Math.floor(4*e/5),f=Math.floor(e/5);f<c;f++){o[(255&s[f])>>r.LUMINANCE_SHIFT]++}var l=r.estimateBlackPoint(o),_=t.getMatrix();for(a=0;a<i;a++){var h=a*e;for(f=0;f<e;f++){(255&_[h+f])<l&&n.set(f,a)}}return n},r.prototype.createBinarizer=function(t){return new r(t)},r.prototype.initArrays=function(t){this.luminances.length<t&&(this.luminances=new Uint8ClampedArray(t));for(var e=this.buckets,i=0;i<r.LUMINANCE_BUCKETS;i++)e[i]=0},r.estimateBlackPoint=function(t){for(var e=t.length,i=0,n=0,o=0,a=0;a<e;a++)t[a]>o&&(n=a,o=t[a]),t[a]>i&&(i=t[a]);var u=0,s=0;for(a=0;a<e;a++){var c=a-n;(h=t[a]*c*c)>s&&(u=a,s=h)}if(n>u){var f=n;n=u,u=f}if(u-n<=e/16)throw new NotFoundException_1.default;var l=u-1,_=-1;for(a=u-1;a>n;a--){var h,p=a-n;(h=p*p*(u-a)*(i-t[a]))>_&&(l=a,_=h)}return l<<r.LUMINANCE_SHIFT},r.LUMINANCE_BITS=5,r.LUMINANCE_SHIFT=8-r.LUMINANCE_BITS,r.LUMINANCE_BUCKETS=1<<r.LUMINANCE_BITS,r.EMPTY=Uint8ClampedArray.from([0]),r}(Binarizer_1.default);exports.default=GlobalHistogramBinarizer;
//# sourceMappingURL=/sm/1295fd4af56145208be6159b1d3424f30d9cc9de03035838b2e10f4a512aa822.map