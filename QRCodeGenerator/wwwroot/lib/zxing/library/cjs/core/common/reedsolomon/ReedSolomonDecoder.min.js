/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/@zxing/library@0.21.0/cjs/core/common/reedsolomon/ReedSolomonDecoder.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var GenericGF_1=require("./GenericGF"),GenericGFPoly_1=require("./GenericGFPoly"),ReedSolomonException_1=require("../../ReedSolomonException"),IllegalStateException_1=require("../../IllegalStateException"),ReedSolomonDecoder=function(){function e(e){this.field=e}return e.prototype.decode=function(e,r){for(var t=this.field,o=new GenericGFPoly_1.default(t,e),i=new Int32Array(r),n=!0,l=0;l<r;l++){var a=o.evaluateAt(t.exp(l+t.getGeneratorBase()));i[i.length-1-l]=a,0!==a&&(n=!1)}if(!n){var u=new GenericGFPoly_1.default(t,i),d=this.runEuclideanAlgorithm(t.buildMonomial(r,1),u,r),f=d[0],g=d[1],c=this.findErrorLocations(f),s=this.findErrorMagnitudes(g,c);for(l=0;l<c.length;l++){var p=e.length-1-t.log(c[l]);if(p<0)throw new ReedSolomonException_1.default("Bad error location");e[p]=GenericGF_1.default.addOrSubtract(e[p],s[l])}}},e.prototype.runEuclideanAlgorithm=function(e,r,t){if(e.getDegree()<r.getDegree()){var o=e;e=r,r=o}for(var i=this.field,n=e,l=r,a=i.getZero(),u=i.getOne();l.getDegree()>=(t/2|0);){var d=n,f=a;if(a=u,(n=l).isZero())throw new ReedSolomonException_1.default("r_{i-1} was zero");l=d;for(var g=i.getZero(),c=n.getCoefficient(n.getDegree()),s=i.inverse(c);l.getDegree()>=n.getDegree()&&!l.isZero();){var p=l.getDegree()-n.getDegree(),m=i.multiply(l.getCoefficient(l.getDegree()),s);g=g.addOrSubtract(i.buildMonomial(p,m)),l=l.addOrSubtract(n.multiplyByMonomial(p,m))}if(u=g.multiply(a).addOrSubtract(f),l.getDegree()>=n.getDegree())throw new IllegalStateException_1.default("Division algorithm failed to reduce polynomial?")}var v=u.getCoefficient(0);if(0===v)throw new ReedSolomonException_1.default("sigmaTilde(0) was zero");var y=i.inverse(v);return[u.multiplyScalar(y),l.multiplyScalar(y)]},e.prototype.findErrorLocations=function(e){var r=e.getDegree();if(1===r)return Int32Array.from([e.getCoefficient(1)]);for(var t=new Int32Array(r),o=0,i=this.field,n=1;n<i.getSize()&&o<r;n++)0===e.evaluateAt(n)&&(t[o]=i.inverse(n),o++);if(o!==r)throw new ReedSolomonException_1.default("Error locator degree does not match number of roots");return t},e.prototype.findErrorMagnitudes=function(e,r){for(var t=r.length,o=new Int32Array(t),i=this.field,n=0;n<t;n++){for(var l=i.inverse(r[n]),a=1,u=0;u<t;u++)if(n!==u){var d=i.multiply(r[u],l),f=0==(1&d)?1|d:-2&d;a=i.multiply(a,f)}o[n]=i.multiply(e.evaluateAt(l),i.inverse(a)),0!==i.getGeneratorBase()&&(o[n]=i.multiply(o[n],l))}return o},e}();exports.default=ReedSolomonDecoder;
//# sourceMappingURL=/sm/bc4f30306df58da026d30c78258c54a9641f44f23efdcc11c67a3e8c891f4372.map