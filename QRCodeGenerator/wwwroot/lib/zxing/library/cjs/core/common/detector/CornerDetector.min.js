/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/@zxing/library@0.21.0/cjs/core/common/detector/CornerDetector.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ResultPoint_1=require("../../ResultPoint"),NotFoundException_1=require("../../NotFoundException"),CornerDetector=function(){function t(t,e,i,n,r){this.image=t,this.height=t.getHeight(),this.width=t.getWidth();var o=e/2;if(this.leftInit=i-o,this.rightInit=i+o,this.upInit=n-o,this.downInit=n+o,this.targetMatrixSize=2*r,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new NotFoundException_1.default}return t.prototype.detect=function(){for(var t=this.leftInit,e=this.rightInit,i=this.upInit,n=this.downInit,r=!1,o=!0,g=!1,s=!1,a=!1,h=!1,u=!1;o;){o=!1;for(var f=!0;(f||!s)&&e<this.width;)(f=this.containsBlackPoint(i,n,e,!1))?(e++,o=!0,s=!0):s||e++;if(e>=this.width){r=!0;break}for(var l=!0;(l||!a)&&n<this.height;)(l=this.containsBlackPoint(t,e,n,!0))?(n++,o=!0,a=!0):a||n++;if(n>=this.height){r=!0;break}for(var d=!0;(d||!h)&&t>=0;)(d=this.containsBlackPoint(i,n,t,!1))?(t--,o=!0,h=!0):h||t--;if(t<0){r=!0;break}for(var c=!0;(c||!u)&&i>=0;)(c=this.containsBlackPoint(t,e,i,!0))?(i--,o=!0,u=!0):u||i--;if(i<0){r=!0;break}o&&(g=!0)}if(!r&&g)return this.findCorners(e,t,n,i);throw new NotFoundException_1.default},t.prototype.findCorners=function(t,e,i,n){var r=t-e,o=i-n,g=16/this.targetMatrixSize,s=4/this.targetMatrixSize,a=r*s,h=o*s,u=a+(t-e)*g,f=h+(i-n)*g,l=new ResultPoint_1.default(e-a,n-h),d=new ResultPoint_1.default(t+a,n-h),c=new ResultPoint_1.default(t+a,i+h),w=new ResultPoint_1.default(e-a,i+h),_=new ResultPoint_1.default(l.getX()+u,l.getY()+f),P=new ResultPoint_1.default(d.getX()-u,d.getY()+f),X=new ResultPoint_1.default(c.getX()-u,c.getY()-f),p=new ResultPoint_1.default(w.getX()+u,w.getY()-f),Y=this.getCornerFromArea(l.getX(),_.getX(),l.getY(),_.getY(),!1,!1),R=this.getCornerFromArea(P.getX(),d.getX(),d.getY(),P.getY(),!0,!1),m=this.getCornerFromArea(X.getX(),c.getX(),X.getY(),c.getY(),!0,!0),v=this.getCornerFromArea(w.getX(),p.getX(),p.getY(),w.getY(),!1,!0),x=(R.getX()-Y.getX())/this.targetMatrixSize,I=(m.getY()-R.getY())/this.targetMatrixSize;return[new ResultPoint_1.default(Y.getX()+x,Y.getY()+I),new ResultPoint_1.default(R.getX()-x,R.getY()+I),new ResultPoint_1.default(m.getX()-x,m.getY()-I),new ResultPoint_1.default(v.getX()+x,v.getY()-I)]},t.prototype.getCornerFromArea=function(t,e,i,n,r,o){for(var g=r?0:Number.MAX_VALUE,s=o?0:Number.MAX_VALUE,a=t;a<e;a++)for(var h=i;h<n;h++)a>0&&h>0&&a<this.image.getWidth()&&h<this.image.getHeight()&&this.image.get(a,h)&&(r?a>g&&(g=a):a<g&&(g=a),o?h>s&&(s=h):h<s&&(s=h));if(0===g||0===s)throw new NotFoundException_1.default;return new ResultPoint_1.default(g,s)},t.prototype.containsBlackPoint=function(t,e,i,n){if(n){for(var r=t;r<=e;r++)if(this.image.get(r,i))return!0}else for(var o=t;o<=e;o++)if(this.image.get(i,o))return!0;return!1},t}();exports.default=CornerDetector;
//# sourceMappingURL=/sm/8c920604c02afd9664a7747147c35a1565a4d35e01762e51d47a28c227f7e6aa.map